{"ast":null,"code":"var _jsxFileName = \"/Users/fedepoi/efu-system/client/src/components/dasboard/mapasderiesgo/GraficoRiesgo.jsx\";\nimport React, { Component } from \"react\";\nimport CanvasJSReact from \"../canvasjs.react\";\nimport { Label, Input } from \"reactstrap\";\nimport { Row, Col, Card, CardBody, Table } from \"reactstrap\";\nimport moment from \"moment\";\nvar CanvasJSChart = CanvasJSReact.CanvasJSChart;\nvar CanvasJS = CanvasJSReact.CanvasJS;\nexport class GraficoRiesgo extends Component {\n  constructor() {\n    super();\n\n    this.onChange = e => {\n      this.setState({\n        [e.target.name]: e.target.value\n      });\n    };\n\n    this.state = {\n      equipo: \"\",\n      familia: \"\"\n    };\n    this.toggleDataSeries = this.toggleDataSeries.bind(this);\n  }\n\n  toggleDataSeries(e) {\n    if (typeof e.dataSeries.visible === \"undefined\" || e.dataSeries.visible) {\n      e.dataSeries.visible = false;\n    } else {\n      e.dataSeries.visible = true;\n    }\n\n    this.chart.render();\n  }\n\n  render() {\n    const {\n      tarjetas\n    } = this.props;\n    var filter = {\n      equipo: this.state.equipo && this.state.equipo,\n      familia: this.state.familia && this.state.familia\n    };\n\n    const multiFilter = (arr, filters) => {\n      const filterKeys = Object.keys(filters);\n      return arr.filter(eachObj => {\n        return filterKeys.every(eachKey => {\n          if (!filters[eachKey].length) {\n            return true; // passing an empty filter means that filter is ignored.\n          }\n\n          return filters[eachKey].includes(eachObj[eachKey]);\n        });\n      });\n    };\n\n    const newFilter = multiFilter(tarjetas, filter);\n    const arrEquipos = tarjetas.map(({\n      equipo\n    }) => equipo);\n    const unicosEquipos = Array.from(new Set(arrEquipos));\n    const arrFamilias = tarjetas.map(({\n      familia\n    }) => familia);\n    const unicosFamilias = Array.from(new Set(arrFamilias)); // Formulas para \"Mapas de Riesgo\"\n    // Cantidad de tarjetas abiertas de newFilter\n\n    const arrAbiertas = newFilter.filter(({\n      estado\n    }) => {\n      return estado === \"Abierta\";\n    });\n    const arrCerradas = newFilter.filter(({\n      estado\n    }) => {\n      return estado === \"Cerrada\";\n    }); // Porcentaje de puntos tratados\n\n    const arrPorcentajePuntos = arrCerradas.length * 100 / newFilter.length; // Nivel Riesgo Inicial\n\n    const arrValuesRiesgoInicial = newFilter && newFilter.map(({\n      riesgoInicial\n    }) => {\n      return parseInt(riesgoInicial);\n    });\n    const nivelRiesgoInicial = arrValuesRiesgoInicial.reduce((a, b) => a + b, 0); // Nivel Riesgo Final\n\n    const arrValuesRiesgoFinal = arrCerradas && arrCerradas.map(({\n      riesgoFinal\n    }) => {\n      return parseInt(riesgoFinal);\n    });\n    const sumArrValuesRiesgoFinal = arrValuesRiesgoFinal.reduce((a, b) => a + b, 0);\n    const arrValuesRiesgoInicialRestantes = arrAbiertas && arrAbiertas.map(({\n      riesgoInicial\n    }) => {\n      return parseInt(riesgoInicial);\n    });\n    const nivelRiesgoInicialRestantes = arrValuesRiesgoInicialRestantes.reduce((a, b) => a + b, 0);\n    const nivelRiesgoFinal = sumArrValuesRiesgoFinal + nivelRiesgoInicialRestantes;\n    const reduccionRiesgo = (nivelRiesgoInicial - nivelRiesgoFinal) / nivelRiesgoInicial * 100;\n    return /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 119,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(Row, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 120,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(Col, {\n      lg: 8,\n      md: 12,\n      sm: 12,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 121,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(Card, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 122,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(CardBody, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 123,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(\"h3\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 124,\n        columnNumber: 17\n      }\n    }, \"Reducci\\xF3n de Riesgo\"), /*#__PURE__*/React.createElement(Table, {\n      className: \"no-wrap v-middle\",\n      responsive: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 125,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"thead\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 126,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(\"tr\", {\n      className: \"border-0\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 127,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"th\", {\n      className: \"border-0\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 128,\n        columnNumber: 23\n      }\n    }))), /*#__PURE__*/React.createElement(\"tbody\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 131,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(\"tr\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 132,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 133,\n        columnNumber: 23\n      }\n    }, \"Tarjetas abiertas | | Tarjetas cerradas\"), /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 134,\n        columnNumber: 23\n      }\n    }, newFilter.length, \" | | \", arrCerradas.length)), /*#__PURE__*/React.createElement(\"tr\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 138,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 139,\n        columnNumber: 23\n      }\n    }, \"Porcentaje de puntos tratados\"), /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 140,\n        columnNumber: 23\n      }\n    }, arrPorcentajePuntos.toFixed(2), \" %\")), /*#__PURE__*/React.createElement(\"tr\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 142,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 143,\n        columnNumber: 23\n      }\n    }, \"Nivel Riesgo Inicial\"), /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 144,\n        columnNumber: 23\n      }\n    }, nivelRiesgoInicial)), /*#__PURE__*/React.createElement(\"tr\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 146,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 147,\n        columnNumber: 23\n      }\n    }, \"Nivel Riesgo Final\"), /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 148,\n        columnNumber: 23\n      }\n    }, nivelRiesgoFinal)), /*#__PURE__*/React.createElement(\"tr\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 150,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 151,\n        columnNumber: 23\n      }\n    }, \"% de Reducci\\xF3n de Riesgo \"), /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 152,\n        columnNumber: 23\n      }\n    }, reduccionRiesgo.toFixed(2), \" %\"))))))), /*#__PURE__*/React.createElement(Col, {\n      lg: 4,\n      md: 12,\n      sm: 12,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 159,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(Card, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 160,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(CardBody, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 161,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(\"h3\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 162,\n        columnNumber: 17\n      }\n    }, \"Filtros\"), /*#__PURE__*/React.createElement(Label, {\n      for: \"equipo\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 163,\n        columnNumber: 17\n      }\n    }, \"Equipo\"), /*#__PURE__*/React.createElement(Input, {\n      type: \"select\",\n      name: \"equipo\",\n      id: \"equipo\",\n      onChange: this.onChange,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 164,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"option\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 170,\n        columnNumber: 19\n      }\n    }), unicosEquipos.map((item, index) => {\n      return /*#__PURE__*/React.createElement(\"option\", {\n        key: index,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 172,\n          columnNumber: 28\n        }\n      }, item);\n    })), /*#__PURE__*/React.createElement(Label, {\n      for: \"equipo\",\n      className: \"mt-3\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 175,\n        columnNumber: 17\n      }\n    }, \"Familia\"), /*#__PURE__*/React.createElement(Input, {\n      type: \"select\",\n      name: \"familia\",\n      id: \"familia\",\n      onChange: this.onChange,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 178,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"option\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 184,\n        columnNumber: 19\n      }\n    }), unicosFamilias.map((item, index) => {\n      return /*#__PURE__*/React.createElement(\"option\", {\n        key: index,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 186,\n          columnNumber: 28\n        }\n      }, item);\n    })))))));\n  }\n\n}\nexport default GraficoRiesgo;","map":{"version":3,"sources":["/Users/fedepoi/efu-system/client/src/components/dasboard/mapasderiesgo/GraficoRiesgo.jsx"],"names":["React","Component","CanvasJSReact","Label","Input","Row","Col","Card","CardBody","Table","moment","CanvasJSChart","CanvasJS","GraficoRiesgo","constructor","onChange","e","setState","target","name","value","state","equipo","familia","toggleDataSeries","bind","dataSeries","visible","chart","render","tarjetas","props","filter","multiFilter","arr","filters","filterKeys","Object","keys","eachObj","every","eachKey","length","includes","newFilter","arrEquipos","map","unicosEquipos","Array","from","Set","arrFamilias","unicosFamilias","arrAbiertas","estado","arrCerradas","arrPorcentajePuntos","arrValuesRiesgoInicial","riesgoInicial","parseInt","nivelRiesgoInicial","reduce","a","b","arrValuesRiesgoFinal","riesgoFinal","sumArrValuesRiesgoFinal","arrValuesRiesgoInicialRestantes","nivelRiesgoInicialRestantes","nivelRiesgoFinal","reduccionRiesgo","toFixed","item","index"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport CanvasJSReact from \"../canvasjs.react\";\nimport { Label, Input } from \"reactstrap\";\nimport { Row, Col, Card, CardBody, Table } from \"reactstrap\";\nimport moment from \"moment\";\nvar CanvasJSChart = CanvasJSReact.CanvasJSChart;\nvar CanvasJS = CanvasJSReact.CanvasJS;\nexport class GraficoRiesgo extends Component {\n  constructor() {\n    super();\n    this.state = {\n      equipo: \"\",\n      familia: \"\",\n    };\n    this.toggleDataSeries = this.toggleDataSeries.bind(this);\n  }\n  toggleDataSeries(e) {\n    if (typeof e.dataSeries.visible === \"undefined\" || e.dataSeries.visible) {\n      e.dataSeries.visible = false;\n    } else {\n      e.dataSeries.visible = true;\n    }\n\n    this.chart.render();\n  }\n  onChange = (e) => {\n    this.setState({\n      [e.target.name]: e.target.value,\n    });\n  };\n\n  render() {\n    const { tarjetas } = this.props;\n\n    var filter = {\n      equipo: this.state.equipo && this.state.equipo,\n      familia: this.state.familia && this.state.familia,\n    };\n\n    const multiFilter = (arr, filters) => {\n      const filterKeys = Object.keys(filters);\n      return arr.filter((eachObj) => {\n        return filterKeys.every((eachKey) => {\n          if (!filters[eachKey].length) {\n            return true; // passing an empty filter means that filter is ignored.\n          }\n          return filters[eachKey].includes(eachObj[eachKey]);\n        });\n      });\n    };\n    const newFilter = multiFilter(tarjetas, filter);\n\n    const arrEquipos = tarjetas.map(({ equipo }) => equipo);\n    const unicosEquipos = Array.from(new Set(arrEquipos));\n\n    const arrFamilias = tarjetas.map(({ familia }) => familia);\n    const unicosFamilias = Array.from(new Set(arrFamilias));\n\n    // Formulas para \"Mapas de Riesgo\"\n\n    // Cantidad de tarjetas abiertas de newFilter\n\n    const arrAbiertas = newFilter.filter(({ estado }) => {\n      return estado === \"Abierta\";\n    });\n\n    const arrCerradas = newFilter.filter(({ estado }) => {\n      return estado === \"Cerrada\";\n    });\n\n    // Porcentaje de puntos tratados\n\n    const arrPorcentajePuntos = (arrCerradas.length * 100) / newFilter.length;\n\n    // Nivel Riesgo Inicial\n\n    const arrValuesRiesgoInicial =\n      newFilter &&\n      newFilter.map(({ riesgoInicial }) => {\n        return parseInt(riesgoInicial);\n      });\n\n    const nivelRiesgoInicial = arrValuesRiesgoInicial.reduce(\n      (a, b) => a + b,\n      0\n    );\n\n    // Nivel Riesgo Final\n\n    const arrValuesRiesgoFinal =\n      arrCerradas &&\n      arrCerradas.map(({ riesgoFinal }) => {\n        return parseInt(riesgoFinal);\n      });\n\n    const sumArrValuesRiesgoFinal = arrValuesRiesgoFinal.reduce(\n      (a, b) => a + b,\n      0\n    );\n\n    const arrValuesRiesgoInicialRestantes =\n      arrAbiertas &&\n      arrAbiertas.map(({ riesgoInicial }) => {\n        return parseInt(riesgoInicial);\n      });\n\n    const nivelRiesgoInicialRestantes = arrValuesRiesgoInicialRestantes.reduce(\n      (a, b) => a + b,\n      0\n    );\n\n    const nivelRiesgoFinal =\n      sumArrValuesRiesgoFinal + nivelRiesgoInicialRestantes;\n\n    const reduccionRiesgo =\n      ((nivelRiesgoInicial - nivelRiesgoFinal) / nivelRiesgoInicial) * 100;\n\n    return (\n      <div>\n        <Row>\n          <Col lg={8} md={12} sm={12}>\n            <Card>\n              <CardBody>\n                <h3>Reducción de Riesgo</h3>\n                <Table className=\"no-wrap v-middle\" responsive>\n                  <thead>\n                    <tr className=\"border-0\">\n                      <th className=\"border-0\"></th>\n                    </tr>\n                  </thead>\n                  <tbody>\n                    <tr>\n                      <td>Tarjetas abiertas | | Tarjetas cerradas</td>\n                      <td>\n                        {newFilter.length} | | {arrCerradas.length}\n                      </td>\n                    </tr>\n                    <tr>\n                      <td>Porcentaje de puntos tratados</td>\n                      <td>{arrPorcentajePuntos.toFixed(2)} %</td>\n                    </tr>\n                    <tr>\n                      <td>Nivel Riesgo Inicial</td>\n                      <td>{nivelRiesgoInicial}</td>\n                    </tr>\n                    <tr>\n                      <td>Nivel Riesgo Final</td>\n                      <td>{nivelRiesgoFinal}</td>\n                    </tr>\n                    <tr>\n                      <td>% de Reducción de Riesgo </td>\n                      <td>{reduccionRiesgo.toFixed(2)} %</td>\n                    </tr>\n                  </tbody>\n                </Table>\n              </CardBody>\n            </Card>\n          </Col>\n          <Col lg={4} md={12} sm={12}>\n            <Card>\n              <CardBody>\n                <h3>Filtros</h3>\n                <Label for=\"equipo\">Equipo</Label>\n                <Input\n                  type=\"select\"\n                  name=\"equipo\"\n                  id=\"equipo\"\n                  onChange={this.onChange}\n                >\n                  <option></option>\n                  {unicosEquipos.map((item, index) => {\n                    return <option key={index}>{item}</option>;\n                  })}\n                </Input>\n                <Label for=\"equipo\" className=\"mt-3\">\n                  Familia\n                </Label>\n                <Input\n                  type=\"select\"\n                  name=\"familia\"\n                  id=\"familia\"\n                  onChange={this.onChange}\n                >\n                  <option></option>\n                  {unicosFamilias.map((item, index) => {\n                    return <option key={index}>{item}</option>;\n                  })}\n                </Input>\n              </CardBody>\n            </Card>\n          </Col>\n        </Row>\n      </div>\n    );\n  }\n}\n\nexport default GraficoRiesgo;\n"]},"metadata":{},"sourceType":"module"}