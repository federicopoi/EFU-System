{"ast":null,"code":"var _jsxFileName = \"/Users/fedepoi/tpm-project-mern/client/src/components/dasboard/indiceautonomia/GraficoAutonomia.jsx\";\nimport React, { Component } from \"react\";\nimport CanvasJSReact from \"../canvasjs.react\";\nvar CanvasJSChart = CanvasJSReact.CanvasJSChart;\nvar CanvasJS = CanvasJSReact.CanvasJS;\nexport class GraficoAutonomia extends Component {\n  constructor() {\n    super();\n    this.toggleDataSeries = this.toggleDataSeries.bind(this);\n  }\n\n  toggleDataSeries(e) {\n    if (typeof e.dataSeries.visible === \"undefined\" || e.dataSeries.visible) {\n      e.dataSeries.visible = false;\n    } else {\n      e.dataSeries.visible = true;\n    }\n\n    this.chart.render();\n  }\n\n  render() {\n    const {\n      tarjetas\n    } = this.props; // Formulas para \"Indice de autonomia\"\n    // Filtro todos los meses en el que hay tarjetas convertidas\n\n    const fechasTarjetasConvertidas = tarjetas // .filter(({ estado, convertida }) => convertida === true)\n    .map(({\n      fecha\n    }) => fecha.substr(0, 7)); // Borro todos los meses repetidos\n\n    let fechasTarjetasConvertidas1 = new Set(fechasTarjetasConvertidas);\n    const fechasTarjetasConvertidasUnicas = [...fechasTarjetasConvertidas1]; // Numero total de tarjetas de cada mes (no acumulado)\n\n    let array1 = fechasTarjetasConvertidasUnicas.sort().map((item, index) => {\n      return tarjetas.filter(({\n        estado,\n        fecha,\n        color\n      }) => color === \"Azul\" && estado === \"Cerrada\" && fecha.substr(4, 4).replace(\"-\", \"\").replace(\"-\", \"\") === item.slice(5, 7)).length;\n    }); // Acumulado de tarjetas por mes\n\n    const array1Acum = array1.map((elem, index) => array1.slice(0, index + 1).reduce((a, b) => a + b)); // Numero total de tarjetas de cada mes (no acumulado)\n\n    let array2 = fechasTarjetasConvertidasUnicas.sort().map((item, index) => {\n      return tarjetas.filter(({\n        estado,\n        fecha,\n        convertida\n      }) => convertida === true && estado === \"Cerrada\" && fecha.substr(4, 4).replace(\"-\", \"\").replace(\"-\", \"\") === item.slice(5, 7)).length;\n    }); // Acumulado de tarjetas por mes\n\n    const array2Acum = array2.map((elem, index) => array2.slice(0, index + 1).reduce((a, b) => a + b)); // Numero total de tarjetas de cada mes (no acumulado)\n\n    let array3 = fechasTarjetasConvertidasUnicas.sort().map((item, index) => {\n      return tarjetas.filter(({\n        estado,\n        fecha\n      }) => estado === \"Cerrada\" && fecha.substr(4, 4).replace(\"-\", \"\").replace(\"-\", \"\") === item.slice(5, 7)).length;\n    });\n    console.log(array1Acum); // Acumulado de tarjetas por mes\n\n    const array3Acum = array3.map((elem, index) => array3.slice(0, index + 1).reduce((a, b) => a + b)); // Numero total de tarjetas de cada mes (no acumulado)\n\n    let arrayAcumFinal = fechasTarjetasConvertidasUnicas.sort().map((item, index) => {\n      return array1[index] + array2[index] / array3[index] * 100;\n    }); // Acumulado de tarjetas por mes\n\n    const arryAcumFinal1 = arrayAcumFinal.map((elem, index) => arrayAcumFinal.slice(0, index + 1).reduce((a, b) => a + b || 0)); // Datos para el grafico\n\n    const ConvertidasData = [fechasTarjetasConvertidasUnicas.sort().map((item, index) => {\n      return {\n        x: new Date(parseInt(item.slice(0, 4)), parseInt(item.slice(5, 7) - 1)),\n        y: arryAcumFinal1[index]\n      };\n    })];\n    CanvasJS.addCultureInfo(\"es\", {\n      decimalSeparator: \",\",\n      // Observe ToolTip Number Format\n      digitGroupSeparator: \".\",\n      // Observe axisY labels\n      months: [\"Enero\", \"Febrero\", \"Marzo\", \"Abril\", \"Mayo\", \"Junio\", \"Julio\", \"Agosto\", \"Septiembre\", \"Octubre\", \"Noviembre\", \"Diciembre\"]\n    });\n    const options = {\n      culture: \"es\",\n      animationEnabled: true,\n      culture: \"es\",\n      axisX: {\n        valueFormatString: \"MMMM\",\n        interval: 1,\n        intervalType: \"month\"\n      },\n      axisY: {\n        suffix: \"%\",\n        lineColor: \"#000000\",\n        tickColor: \"#000000\",\n        labelFontColor: \"#000000\"\n      },\n      toolTip: {\n        shared: true\n      },\n      legend: {\n        cursor: \"pointer\",\n        itemclick: this.toggleDataSeries,\n        verticalAlign: \"top\"\n      },\n      data: [{\n        color: \"#1BA7F7\",\n        type: \"column\",\n        name: \"Indice de autonomia\",\n        showInLegend: true,\n        xValueFormatString: \"MMMM YYYY\",\n        dataPoints: ConvertidasData[0]\n      }]\n    };\n    return /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 165,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(CanvasJSChart, {\n      culture: \"en\",\n      options: options,\n      onRef: ref => this.chart = ref,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 166,\n        columnNumber: 9\n      }\n    }));\n  }\n\n}\nexport default GraficoAutonomia;","map":{"version":3,"sources":["/Users/fedepoi/tpm-project-mern/client/src/components/dasboard/indiceautonomia/GraficoAutonomia.jsx"],"names":["React","Component","CanvasJSReact","CanvasJSChart","CanvasJS","GraficoAutonomia","constructor","toggleDataSeries","bind","e","dataSeries","visible","chart","render","tarjetas","props","fechasTarjetasConvertidas","map","fecha","substr","fechasTarjetasConvertidas1","Set","fechasTarjetasConvertidasUnicas","array1","sort","item","index","filter","estado","color","replace","slice","length","array1Acum","elem","reduce","a","b","array2","convertida","array2Acum","array3","console","log","array3Acum","arrayAcumFinal","arryAcumFinal1","ConvertidasData","x","Date","parseInt","y","addCultureInfo","decimalSeparator","digitGroupSeparator","months","options","culture","animationEnabled","axisX","valueFormatString","interval","intervalType","axisY","suffix","lineColor","tickColor","labelFontColor","toolTip","shared","legend","cursor","itemclick","verticalAlign","data","type","name","showInLegend","xValueFormatString","dataPoints","ref"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport CanvasJSReact from \"../canvasjs.react\";\nvar CanvasJSChart = CanvasJSReact.CanvasJSChart;\nvar CanvasJS = CanvasJSReact.CanvasJS;\nexport class GraficoAutonomia extends Component {\n  constructor() {\n    super();\n    this.toggleDataSeries = this.toggleDataSeries.bind(this);\n  }\n  toggleDataSeries(e) {\n    if (typeof e.dataSeries.visible === \"undefined\" || e.dataSeries.visible) {\n      e.dataSeries.visible = false;\n    } else {\n      e.dataSeries.visible = true;\n    }\n\n    this.chart.render();\n  }\n\n  render() {\n    const { tarjetas } = this.props;\n\n    // Formulas para \"Indice de autonomia\"\n\n    // Filtro todos los meses en el que hay tarjetas convertidas\n    const fechasTarjetasConvertidas = tarjetas\n      // .filter(({ estado, convertida }) => convertida === true)\n      .map(({ fecha }) => fecha.substr(0, 7));\n\n    // Borro todos los meses repetidos\n    let fechasTarjetasConvertidas1 = new Set(fechasTarjetasConvertidas);\n    const fechasTarjetasConvertidasUnicas = [...fechasTarjetasConvertidas1];\n\n    // Numero total de tarjetas de cada mes (no acumulado)\n    let array1 = fechasTarjetasConvertidasUnicas.sort().map((item, index) => {\n      return tarjetas.filter(\n        ({ estado, fecha, color }) =>\n          color === \"Azul\" &&\n          estado === \"Cerrada\" &&\n          fecha.substr(4, 4).replace(\"-\", \"\").replace(\"-\", \"\") ===\n            item.slice(5, 7)\n      ).length;\n    });\n\n    // Acumulado de tarjetas por mes\n    const array1Acum = array1.map((elem, index) =>\n      array1.slice(0, index + 1).reduce((a, b) => a + b)\n    );\n\n    // Numero total de tarjetas de cada mes (no acumulado)\n    let array2 = fechasTarjetasConvertidasUnicas.sort().map((item, index) => {\n      return tarjetas.filter(\n        ({ estado, fecha, convertida }) =>\n          convertida === true &&\n          estado === \"Cerrada\" &&\n          fecha.substr(4, 4).replace(\"-\", \"\").replace(\"-\", \"\") ===\n            item.slice(5, 7)\n      ).length;\n    });\n\n    // Acumulado de tarjetas por mes\n    const array2Acum = array2.map((elem, index) =>\n      array2.slice(0, index + 1).reduce((a, b) => a + b)\n    );\n\n    // Numero total de tarjetas de cada mes (no acumulado)\n    let array3 = fechasTarjetasConvertidasUnicas.sort().map((item, index) => {\n      return tarjetas.filter(\n        ({ estado, fecha }) =>\n          estado === \"Cerrada\" &&\n          fecha.substr(4, 4).replace(\"-\", \"\").replace(\"-\", \"\") ===\n            item.slice(5, 7)\n      ).length;\n    });\n\n    console.log(array1Acum);\n\n    // Acumulado de tarjetas por mes\n    const array3Acum = array3.map((elem, index) =>\n      array3.slice(0, index + 1).reduce((a, b) => a + b)\n    );\n\n    // Numero total de tarjetas de cada mes (no acumulado)\n    let arrayAcumFinal = fechasTarjetasConvertidasUnicas\n      .sort()\n      .map((item, index) => {\n        return array1[index] + (array2[index] / array3[index]) * 100;\n      });\n\n    // Acumulado de tarjetas por mes\n    const arryAcumFinal1 = arrayAcumFinal.map((elem, index) =>\n      arrayAcumFinal.slice(0, index + 1).reduce((a, b) => a + b || 0)\n    );\n\n    // Datos para el grafico\n    const ConvertidasData = [\n      fechasTarjetasConvertidasUnicas.sort().map((item, index) => {\n        return {\n          x: new Date(\n            parseInt(item.slice(0, 4)),\n            parseInt(item.slice(5, 7) - 1)\n          ),\n          y: arryAcumFinal1[index],\n        };\n      }),\n    ];\n\n    CanvasJS.addCultureInfo(\"es\", {\n      decimalSeparator: \",\", // Observe ToolTip Number Format\n      digitGroupSeparator: \".\", // Observe axisY labels\n\n      months: [\n        \"Enero\",\n        \"Febrero\",\n        \"Marzo\",\n        \"Abril\",\n        \"Mayo\",\n        \"Junio\",\n        \"Julio\",\n        \"Agosto\",\n        \"Septiembre\",\n        \"Octubre\",\n        \"Noviembre\",\n        \"Diciembre\",\n      ],\n    });\n    const options = {\n      culture: \"es\",\n      animationEnabled: true,\n      culture: \"es\",\n      axisX: {\n        valueFormatString: \"MMMM\",\n\n        interval: 1,\n        intervalType: \"month\",\n      },\n      axisY: {\n        suffix: \"%\",\n        lineColor: \"#000000\",\n        tickColor: \"#000000\",\n        labelFontColor: \"#000000\",\n      },\n\n      toolTip: {\n        shared: true,\n      },\n      legend: {\n        cursor: \"pointer\",\n        itemclick: this.toggleDataSeries,\n        verticalAlign: \"top\",\n      },\n      data: [\n        {\n          color: \"#1BA7F7\",\n          type: \"column\",\n          name: \"Indice de autonomia\",\n          showInLegend: true,\n          xValueFormatString: \"MMMM YYYY\",\n          dataPoints: ConvertidasData[0],\n        },\n      ],\n    };\n\n    return (\n      <div>\n        <CanvasJSChart\n          culture=\"en\"\n          options={options}\n          onRef={(ref) => (this.chart = ref)}\n        />\n      </div>\n    );\n  }\n}\n\nexport default GraficoAutonomia;\n"]},"metadata":{},"sourceType":"module"}