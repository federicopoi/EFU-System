{"ast":null,"code":"var _jsxFileName = \"/Users/fedepoi/klockner_tpm/client/src/components/dasboard/mapasderiesgo/GraficoRiesgo.jsx\";\nimport React, { Component } from \"react\";\nimport CanvasJSReact from \"../canvasjs.react\";\nimport { Label, Input } from \"reactstrap\";\nimport { Row, Col, Card, CardBody, Table } from \"reactstrap\";\nimport moment from \"moment\";\nvar CanvasJSChart = CanvasJSReact.CanvasJSChart;\nvar CanvasJS = CanvasJSReact.CanvasJS;\nexport class GraficoRiesgo extends Component {\n  constructor() {\n    super();\n\n    this.onChange = e => {\n      this.setState({\n        [e.target.name]: e.target.value\n      });\n    };\n\n    this.state = {\n      equipo: \"\",\n      familia: \"\"\n    };\n    this.toggleDataSeries = this.toggleDataSeries.bind(this);\n  }\n\n  toggleDataSeries(e) {\n    if (typeof e.dataSeries.visible === \"undefined\" || e.dataSeries.visible) {\n      e.dataSeries.visible = false;\n    } else {\n      e.dataSeries.visible = true;\n    }\n\n    this.chart.render();\n  }\n\n  render() {\n    const {\n      tarjetas\n    } = this.props;\n    var filter = {\n      equipo: this.state.equipo && this.state.equipo,\n      familia: this.state.familia && this.state.familia\n    };\n\n    const multiFilter = (arr, filters) => {\n      const filterKeys = Object.keys(filters);\n      return arr.filter(eachObj => {\n        return filterKeys.every(eachKey => {\n          if (!filters[eachKey].length) {\n            return true; // passing an empty filter means that filter is ignored.\n          }\n\n          return filters[eachKey].includes(eachObj[eachKey]);\n        });\n      });\n    };\n\n    const newFilter = multiFilter(tarjetas, filter);\n    const arrEquipos = tarjetas.map(({\n      equipo\n    }) => equipo);\n    const unicosEquipos = Array.from(new Set(arrEquipos));\n    const arrFamilias = tarjetas.map(({\n      familia\n    }) => familia);\n    const unicosFamilias = Array.from(new Set(arrFamilias)); // Formulas para \"Mapas de Riesgo\"\n    // Cantidad de tarjetas abiertas de newFilter\n\n    const arrAbiertas = newFilter.filter(({\n      estado\n    }) => {\n      return estado === \"Abierta\";\n    }); // Porcentaje de puntos tratados\n\n    const arrPorcentajePuntos = arrAbiertas.length / newFilter.length * 100; // Nivel Riesgo Inicial\n    // No significativo\n\n    const RI1 = newFilter.filter(({\n      riesgoInicial\n    }) => riesgoInicial.includes(\"NS: No Significativo\")).length;\n    console.log(RI1); // Poco significativo\n\n    const RI2 = newFilter.filter(({\n      riesgoInicial\n    }) => riesgoInicial.includes(\"PS: Poco Significativo\")).length * 2; // Moderado\n\n    const RI3 = newFilter.filter(({\n      riesgoInicial\n    }) => riesgoInicial.includes(\"MO: Moderado\")).length * 3; // Sigfificativo\n\n    const RI4 = newFilter.filter(({\n      riesgoInicial\n    }) => riesgoInicial.includes(\"SI: Significativo\")).length * 4; // Intolerable\n\n    const RI5 = newFilter.filter(({\n      riesgoInicial\n    }) => riesgoInicial.includes(\"IN: Intolerable\")).length * 5;\n    const nivelRiesgoInicial = RI1 + RI2 + RI3 + RI4 + RI5; // Nivel Riesgo Final\n    // No significativo\n\n    const RI1A = arrAbiertas.filter(({\n      riesgoInicial\n    }) => riesgoInicial.includes(\"NS: No Significativo\")).length;\n    console.log(RI1); // Poco significativo\n\n    const RI2A = arrAbiertas.filter(({\n      riesgoInicial\n    }) => riesgoInicial.includes(\"PS: Poco Significativo\")).length * 2; // Moderado\n\n    const RI3A = arrAbiertas.filter(({\n      riesgoInicial\n    }) => riesgoInicial.includes(\"MO: Moderado\")).length * 3; // Sigfificativo\n\n    const RI4A = arrAbiertas.filter(({\n      riesgoInicial\n    }) => riesgoInicial.includes(\"SI: Significativo\")).length * 4; // Intolerable\n\n    const RI5A = arrAbiertas.filter(({\n      riesgoFinal\n    }) => riesgoFinal.includes(\"IN: Intolerable\")).length * 5;\n    const nivelRiesgoFinal = RI1A + RI2A + RI3A + RI4A + RI5A;\n    const reduccionRiesgo = (nivelRiesgoInicial - nivelRiesgoFinal) / nivelRiesgoInicial * 100;\n    return /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 145,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(Row, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 146,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(Col, {\n      lg: 8,\n      md: 12,\n      sm: 12,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 147,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(Card, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 148,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(CardBody, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 149,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(\"h3\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 150,\n        columnNumber: 17\n      }\n    }, \"Tabla Mapas de riesgo\"), /*#__PURE__*/React.createElement(Table, {\n      className: \"no-wrap v-middle\",\n      responsive: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 151,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"thead\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 152,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(\"tr\", {\n      className: \"border-0\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 153,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"th\", {\n      className: \"border-0\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 154,\n        columnNumber: 23\n      }\n    }))), /*#__PURE__*/React.createElement(\"tbody\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 157,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(\"tr\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 158,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 159,\n        columnNumber: 23\n      }\n    }, \"Total de Puntos\"), /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 160,\n        columnNumber: 23\n      }\n    }, newFilter.length, \" | | \", arrAbiertas.length)), /*#__PURE__*/React.createElement(\"tr\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 164,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 165,\n        columnNumber: 23\n      }\n    }, \"Porcentaje de puntos tratados\"), /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 166,\n        columnNumber: 23\n      }\n    }, arrPorcentajePuntos.toFixed(2), \" %\")), /*#__PURE__*/React.createElement(\"tr\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 168,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 169,\n        columnNumber: 23\n      }\n    }, \"Nivel Riesgo Inicial\"), /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 170,\n        columnNumber: 23\n      }\n    }, nivelRiesgoInicial)), /*#__PURE__*/React.createElement(\"tr\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 172,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 173,\n        columnNumber: 23\n      }\n    }, \"Nivel Riesgo Final\"), /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 174,\n        columnNumber: 23\n      }\n    }, nivelRiesgoFinal)), /*#__PURE__*/React.createElement(\"tr\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 176,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 177,\n        columnNumber: 23\n      }\n    }, \"% de Reducci\\xF3n de Riesgo \"), /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 178,\n        columnNumber: 23\n      }\n    }, reduccionRiesgo.toFixed(2), \" %\"))))))), /*#__PURE__*/React.createElement(Col, {\n      lg: 4,\n      md: 12,\n      sm: 12,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 185,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(Card, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 186,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(CardBody, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 187,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(\"h3\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 188,\n        columnNumber: 17\n      }\n    }, \"Filtros\"), /*#__PURE__*/React.createElement(Label, {\n      for: \"equipo\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 189,\n        columnNumber: 17\n      }\n    }, \"Equipo\"), /*#__PURE__*/React.createElement(Input, {\n      type: \"select\",\n      name: \"equipo\",\n      id: \"equipo\",\n      onChange: this.onChange,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 190,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"option\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 196,\n        columnNumber: 19\n      }\n    }), unicosEquipos.map((item, index) => {\n      return /*#__PURE__*/React.createElement(\"option\", {\n        key: index,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 198,\n          columnNumber: 28\n        }\n      }, item);\n    })), /*#__PURE__*/React.createElement(Label, {\n      for: \"equipo\",\n      className: \"mt-3\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 201,\n        columnNumber: 17\n      }\n    }, \"Familia\"), /*#__PURE__*/React.createElement(Input, {\n      type: \"select\",\n      name: \"familia\",\n      id: \"familia\",\n      onChange: this.onChange,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 204,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"option\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 210,\n        columnNumber: 19\n      }\n    }), unicosFamilias.map((item, index) => {\n      return /*#__PURE__*/React.createElement(\"option\", {\n        key: index,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 212,\n          columnNumber: 28\n        }\n      }, item);\n    })))))));\n  }\n\n}\nexport default GraficoRiesgo;","map":{"version":3,"sources":["/Users/fedepoi/klockner_tpm/client/src/components/dasboard/mapasderiesgo/GraficoRiesgo.jsx"],"names":["React","Component","CanvasJSReact","Label","Input","Row","Col","Card","CardBody","Table","moment","CanvasJSChart","CanvasJS","GraficoRiesgo","constructor","onChange","e","setState","target","name","value","state","equipo","familia","toggleDataSeries","bind","dataSeries","visible","chart","render","tarjetas","props","filter","multiFilter","arr","filters","filterKeys","Object","keys","eachObj","every","eachKey","length","includes","newFilter","arrEquipos","map","unicosEquipos","Array","from","Set","arrFamilias","unicosFamilias","arrAbiertas","estado","arrPorcentajePuntos","RI1","riesgoInicial","console","log","RI2","RI3","RI4","RI5","nivelRiesgoInicial","RI1A","RI2A","RI3A","RI4A","RI5A","riesgoFinal","nivelRiesgoFinal","reduccionRiesgo","toFixed","item","index"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport CanvasJSReact from \"../canvasjs.react\";\nimport { Label, Input } from \"reactstrap\";\nimport { Row, Col, Card, CardBody, Table } from \"reactstrap\";\nimport moment from \"moment\";\nvar CanvasJSChart = CanvasJSReact.CanvasJSChart;\nvar CanvasJS = CanvasJSReact.CanvasJS;\nexport class GraficoRiesgo extends Component {\n  constructor() {\n    super();\n    this.state = {\n      equipo: \"\",\n      familia: \"\",\n    };\n    this.toggleDataSeries = this.toggleDataSeries.bind(this);\n  }\n  toggleDataSeries(e) {\n    if (typeof e.dataSeries.visible === \"undefined\" || e.dataSeries.visible) {\n      e.dataSeries.visible = false;\n    } else {\n      e.dataSeries.visible = true;\n    }\n\n    this.chart.render();\n  }\n  onChange = (e) => {\n    this.setState({\n      [e.target.name]: e.target.value,\n    });\n  };\n\n  render() {\n    const { tarjetas } = this.props;\n\n    var filter = {\n      equipo: this.state.equipo && this.state.equipo,\n      familia: this.state.familia && this.state.familia,\n    };\n\n    const multiFilter = (arr, filters) => {\n      const filterKeys = Object.keys(filters);\n      return arr.filter((eachObj) => {\n        return filterKeys.every((eachKey) => {\n          if (!filters[eachKey].length) {\n            return true; // passing an empty filter means that filter is ignored.\n          }\n          return filters[eachKey].includes(eachObj[eachKey]);\n        });\n      });\n    };\n    const newFilter = multiFilter(tarjetas, filter);\n\n    const arrEquipos = tarjetas.map(({ equipo }) => equipo);\n    const unicosEquipos = Array.from(new Set(arrEquipos));\n\n    const arrFamilias = tarjetas.map(({ familia }) => familia);\n    const unicosFamilias = Array.from(new Set(arrFamilias));\n\n    // Formulas para \"Mapas de Riesgo\"\n\n    // Cantidad de tarjetas abiertas de newFilter\n\n    const arrAbiertas = newFilter.filter(({ estado }) => {\n      return estado === \"Abierta\";\n    });\n\n    // Porcentaje de puntos tratados\n\n    const arrPorcentajePuntos = (arrAbiertas.length / newFilter.length) * 100;\n\n    // Nivel Riesgo Inicial\n\n    // No significativo\n    const RI1 = newFilter.filter(({ riesgoInicial }) =>\n      riesgoInicial.includes(\"NS: No Significativo\")\n    ).length;\n\n    console.log(RI1);\n\n    // Poco significativo\n    const RI2 =\n      newFilter.filter(({ riesgoInicial }) =>\n        riesgoInicial.includes(\"PS: Poco Significativo\")\n      ).length * 2;\n\n    // Moderado\n    const RI3 =\n      newFilter.filter(({ riesgoInicial }) =>\n        riesgoInicial.includes(\"MO: Moderado\")\n      ).length * 3;\n\n    // Sigfificativo\n    const RI4 =\n      newFilter.filter(({ riesgoInicial }) =>\n        riesgoInicial.includes(\"SI: Significativo\")\n      ).length * 4;\n\n    // Intolerable\n    const RI5 =\n      newFilter.filter(({ riesgoInicial }) =>\n        riesgoInicial.includes(\"IN: Intolerable\")\n      ).length * 5;\n\n    const nivelRiesgoInicial = RI1 + RI2 + RI3 + RI4 + RI5;\n\n    // Nivel Riesgo Final\n\n    // No significativo\n    const RI1A = arrAbiertas.filter(({ riesgoInicial }) =>\n      riesgoInicial.includes(\"NS: No Significativo\")\n    ).length;\n\n    console.log(RI1);\n\n    // Poco significativo\n    const RI2A =\n      arrAbiertas.filter(({ riesgoInicial }) =>\n        riesgoInicial.includes(\"PS: Poco Significativo\")\n      ).length * 2;\n\n    // Moderado\n    const RI3A =\n      arrAbiertas.filter(({ riesgoInicial }) =>\n        riesgoInicial.includes(\"MO: Moderado\")\n      ).length * 3;\n\n    // Sigfificativo\n    const RI4A =\n      arrAbiertas.filter(({ riesgoInicial }) =>\n        riesgoInicial.includes(\"SI: Significativo\")\n      ).length * 4;\n\n    // Intolerable\n    const RI5A =\n      arrAbiertas.filter(({ riesgoFinal }) =>\n        riesgoFinal.includes(\"IN: Intolerable\")\n      ).length * 5;\n\n    const nivelRiesgoFinal = RI1A + RI2A + RI3A + RI4A + RI5A;\n\n    const reduccionRiesgo =\n      ((nivelRiesgoInicial - nivelRiesgoFinal) / nivelRiesgoInicial) * 100;\n\n    return (\n      <div>\n        <Row>\n          <Col lg={8} md={12} sm={12}>\n            <Card>\n              <CardBody>\n                <h3>Tabla Mapas de riesgo</h3>\n                <Table className=\"no-wrap v-middle\" responsive>\n                  <thead>\n                    <tr className=\"border-0\">\n                      <th className=\"border-0\"></th>\n                    </tr>\n                  </thead>\n                  <tbody>\n                    <tr>\n                      <td>Total de Puntos</td>\n                      <td>\n                        {newFilter.length} | | {arrAbiertas.length}\n                      </td>\n                    </tr>\n                    <tr>\n                      <td>Porcentaje de puntos tratados</td>\n                      <td>{arrPorcentajePuntos.toFixed(2)} %</td>\n                    </tr>\n                    <tr>\n                      <td>Nivel Riesgo Inicial</td>\n                      <td>{nivelRiesgoInicial}</td>\n                    </tr>\n                    <tr>\n                      <td>Nivel Riesgo Final</td>\n                      <td>{nivelRiesgoFinal}</td>\n                    </tr>\n                    <tr>\n                      <td>% de Reducción de Riesgo </td>\n                      <td>{reduccionRiesgo.toFixed(2)} %</td>\n                    </tr>\n                  </tbody>\n                </Table>\n              </CardBody>\n            </Card>\n          </Col>\n          <Col lg={4} md={12} sm={12}>\n            <Card>\n              <CardBody>\n                <h3>Filtros</h3>\n                <Label for=\"equipo\">Equipo</Label>\n                <Input\n                  type=\"select\"\n                  name=\"equipo\"\n                  id=\"equipo\"\n                  onChange={this.onChange}\n                >\n                  <option></option>\n                  {unicosEquipos.map((item, index) => {\n                    return <option key={index}>{item}</option>;\n                  })}\n                </Input>\n                <Label for=\"equipo\" className=\"mt-3\">\n                  Familia\n                </Label>\n                <Input\n                  type=\"select\"\n                  name=\"familia\"\n                  id=\"familia\"\n                  onChange={this.onChange}\n                >\n                  <option></option>\n                  {unicosFamilias.map((item, index) => {\n                    return <option key={index}>{item}</option>;\n                  })}\n                </Input>\n              </CardBody>\n            </Card>\n          </Col>\n        </Row>\n      </div>\n    );\n  }\n}\n\nexport default GraficoRiesgo;\n"]},"metadata":{},"sourceType":"module"}