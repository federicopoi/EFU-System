{"ast":null,"code":"var _jsxFileName = \"/Users/fedepoi/klockner_tpm/client/src/components/dasboard/mapasderiesgo/GraficoRiesgo.jsx\";\nimport React, { Component } from \"react\";\nimport CanvasJSReact from \"../canvasjs.react\";\nimport { Label, Input } from \"reactstrap\";\nimport { Row, Col, Card, CardBody, Table } from \"reactstrap\";\nimport moment from \"moment\";\nvar CanvasJSChart = CanvasJSReact.CanvasJSChart;\nvar CanvasJS = CanvasJSReact.CanvasJS;\nexport class GraficoRiesgo extends Component {\n  constructor() {\n    super();\n\n    this.onChange = e => {\n      this.setState({\n        [e.target.name]: e.target.value\n      });\n    };\n\n    this.state = {\n      equipo: \"\",\n      familia: \"\"\n    };\n    this.toggleDataSeries = this.toggleDataSeries.bind(this);\n  }\n\n  toggleDataSeries(e) {\n    if (typeof e.dataSeries.visible === \"undefined\" || e.dataSeries.visible) {\n      e.dataSeries.visible = false;\n    } else {\n      e.dataSeries.visible = true;\n    }\n\n    this.chart.render();\n  }\n\n  render() {\n    const {\n      tarjetas\n    } = this.props;\n    var filter = {\n      equipo: this.state.equipo && this.state.equipo,\n      familia: this.state.familia && this.state.familia\n    };\n\n    const multiFilter = (arr, filters) => {\n      const filterKeys = Object.keys(filters);\n      return arr.filter(eachObj => {\n        return filterKeys.every(eachKey => {\n          if (!filters[eachKey].length) {\n            return true; // passing an empty filter means that filter is ignored.\n          }\n\n          return filters[eachKey].includes(eachObj[eachKey]);\n        });\n      });\n    };\n\n    const newFilter = multiFilter(tarjetas, filter);\n    const arrEquipos = tarjetas.map(({\n      equipo\n    }) => equipo);\n    const unicosEquipos = Array.from(new Set(arrEquipos));\n    const arrFamilias = tarjetas.map(({\n      familia\n    }) => familia);\n    const unicosFamilias = Array.from(new Set(arrFamilias)); // Formulas para \"Mapas de Riesgo\"\n    // Cantidad de tarjetas abiertas de newFilter\n\n    const arrAbiertas = newFilter.filter(({\n      estado\n    }) => {\n      return estado === \"Abierta\";\n    });\n    const arrCerradas = newFilter.filter(({\n      estado\n    }) => {\n      return estado === \"Cerrada\";\n    }); // Porcentaje de puntos tratados\n\n    const arrPorcentajePuntos = arrCerradas.length * 100 / newFilter.length; // Nivel Riesgo Inicial\n    // No significativo\n\n    const RI1 = newFilter.filter(({\n      riesgoInicial\n    }) => riesgoInicial.toLowerCase().includes(\"NS: NO SIGNIFICATIVO\".toLowerCase())).length; // Poco significativo\n\n    const RI2 = newFilter.filter(({\n      riesgoInicial\n    }) => riesgoInicial.toLowerCase().includes(\"PS: POCO SIGNIFICATIVO\".toLowerCase())).length * 2; // Moderado\n\n    const RI3 = newFilter.filter(({\n      riesgoInicial\n    }) => riesgoInicial.toLowerCase().includes(\"MO: MODERADO\".toLowerCase())).length * 3; // Sigfificativo\n\n    const RI4 = newFilter.filter(({\n      riesgoInicial\n    }) => riesgoInicial.toLowerCase().includes(\"SI: SIGNIFICATIVO\".toLowerCase())).length * 4; // Intolerable\n\n    const RI5 = newFilter.filter(({\n      riesgoInicial\n    }) => riesgoInicial.toLowerCase().includes(\"IN: INTOLERABLE\".toLowerCase())).length * 5;\n    const nivelRiesgoInicial = RI1 + RI2 + RI3 + RI4 + RI5; // Nivel Riesgo Final\n    // No significativo\n\n    const RI1A = arrCerradas.filter(({\n      riesgoFinal\n    }) => riesgoFinal.toLowerCase() === \"NS: NO SIGNIFICATIVO\".toLowerCase()).length; // Poco significativo\n\n    const RI2A = arrCerradas.filter(({\n      riesgoFinal\n    }) => riesgoFinal.toLowerCase() === \"PS: POCO SIGNIFICATIVO\".toLowerCase()).length * 2; // Moderado\n\n    const RI3A = arrCerradas.filter(({\n      riesgoFinal\n    }) => riesgoFinal.toLowerCase() === \"MO: MODERADO\".toLowerCase()).length * 3; // Sigfificativo\n\n    const RI4A = arrCerradas.filter(({\n      riesgoFinal\n    }) => riesgoFinal.toLowerCase() === \"SI: SIGNIFICATIVO\".toLowerCase()).length * 4; // Intolerable\n\n    const RI5A = arrCerradas.filter(({\n      riesgoFinal\n    }) => riesgoFinal.toLowerCase() === \"IN: INTOLERABLE\".toLowerCase()).length * 5; // No significativo\n\n    const RI1B = arrAbiertas.filter(({\n      riesgoInicial\n    }) => riesgoInicial.toLowerCase().includes(\"NS: NO SIGNIFICATIVO\".toLowerCase())).length; // Poco significativo\n\n    const RI2B = arrAbiertas.filter(({\n      riesgoInicial\n    }) => riesgoInicial.toLowerCase().includes(\"PS: POCO SIGNIFICATIVO\".toLowerCase())).length * 2; // Moderado\n\n    const RI3B = arrAbiertas.filter(({\n      riesgoInicial\n    }) => riesgoInicial.toLowerCase().includes(\"MO: MODERADO\".toLowerCase())).length * 3; // Sigfificativo\n\n    const RI4B = arrAbiertas.filter(({\n      riesgoInicial\n    }) => riesgoInicial.toLowerCase().includes(\"SI: SIGNIFICATIVO\".toLowerCase())).length * 4; // Intolerable\n\n    const RI5B = arrAbiertas.filter(({\n      riesgoInicial\n    }) => riesgoInicial.toLowerCase().includes(\"IN: INTOLERABLE\".toLowerCase())).length * 5;\n    const nivelRiesgoFinal = RI1A + RI2A + RI3A + RI4A + RI5A + RI1B + RI2B + RI3B + RI4B + RI5B;\n    console.log(\"+\");\n    console.log(RI1B);\n    console.log(arrAbiertas.filter(({\n      riesgoInicial\n    }) => riesgoInicial.toLowerCase().includes(\"PS: POCO SIGNIFICATIVO\".toLowerCase())));\n    console.log(RI3B);\n    console.log(RI4B);\n    console.log(RI5B);\n    const reduccionRiesgo = (nivelRiesgoInicial - nivelRiesgoFinal) / nivelRiesgoInicial * 100;\n    return /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 197,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(Row, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 198,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(Col, {\n      lg: 8,\n      md: 12,\n      sm: 12,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 199,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(Card, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 200,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(CardBody, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 201,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(\"h3\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 202,\n        columnNumber: 17\n      }\n    }, \"Tabla Mapas de riesgo\"), /*#__PURE__*/React.createElement(Table, {\n      className: \"no-wrap v-middle\",\n      responsive: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 203,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"thead\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 204,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(\"tr\", {\n      className: \"border-0\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 205,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"th\", {\n      className: \"border-0\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 206,\n        columnNumber: 23\n      }\n    }))), /*#__PURE__*/React.createElement(\"tbody\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 209,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(\"tr\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 210,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 211,\n        columnNumber: 23\n      }\n    }, \"Tarjetas abiertas | | Tarjetas cerradas\"), /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 212,\n        columnNumber: 23\n      }\n    }, newFilter.length, \" | | \", arrCerradas.length)), /*#__PURE__*/React.createElement(\"tr\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 216,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 217,\n        columnNumber: 23\n      }\n    }, \"Porcentaje de puntos tratados (% de tarjetas cerradas)\"), /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 220,\n        columnNumber: 23\n      }\n    }, arrPorcentajePuntos.toFixed(2), \" %\")), /*#__PURE__*/React.createElement(\"tr\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 222,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 223,\n        columnNumber: 23\n      }\n    }, \"Nivel Riesgo Inicial\"), /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 224,\n        columnNumber: 23\n      }\n    }, nivelRiesgoInicial)), /*#__PURE__*/React.createElement(\"tr\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 226,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 227,\n        columnNumber: 23\n      }\n    }, \"Nivel Riesgo Final\"), /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 228,\n        columnNumber: 23\n      }\n    }, nivelRiesgoFinal)), /*#__PURE__*/React.createElement(\"tr\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 230,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 231,\n        columnNumber: 23\n      }\n    }, \"% de Reducci\\xF3n de Riesgo \"), /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 232,\n        columnNumber: 23\n      }\n    }, reduccionRiesgo.toFixed(2), \" %\"))))))), /*#__PURE__*/React.createElement(Col, {\n      lg: 4,\n      md: 12,\n      sm: 12,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 239,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(Card, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 240,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(CardBody, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 241,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(\"h3\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 242,\n        columnNumber: 17\n      }\n    }, \"Filtros\"), /*#__PURE__*/React.createElement(Label, {\n      for: \"equipo\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 243,\n        columnNumber: 17\n      }\n    }, \"Equipo\"), /*#__PURE__*/React.createElement(Input, {\n      type: \"select\",\n      name: \"equipo\",\n      id: \"equipo\",\n      onChange: this.onChange,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 244,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"option\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 250,\n        columnNumber: 19\n      }\n    }), unicosEquipos.map((item, index) => {\n      return /*#__PURE__*/React.createElement(\"option\", {\n        key: index,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 252,\n          columnNumber: 28\n        }\n      }, item);\n    })), /*#__PURE__*/React.createElement(Label, {\n      for: \"equipo\",\n      className: \"mt-3\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 255,\n        columnNumber: 17\n      }\n    }, \"Familia\"), /*#__PURE__*/React.createElement(Input, {\n      type: \"select\",\n      name: \"familia\",\n      id: \"familia\",\n      onChange: this.onChange,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 258,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"option\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 264,\n        columnNumber: 19\n      }\n    }), unicosFamilias.map((item, index) => {\n      return /*#__PURE__*/React.createElement(\"option\", {\n        key: index,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 266,\n          columnNumber: 28\n        }\n      }, item);\n    })))))));\n  }\n\n}\nexport default GraficoRiesgo;","map":{"version":3,"sources":["/Users/fedepoi/klockner_tpm/client/src/components/dasboard/mapasderiesgo/GraficoRiesgo.jsx"],"names":["React","Component","CanvasJSReact","Label","Input","Row","Col","Card","CardBody","Table","moment","CanvasJSChart","CanvasJS","GraficoRiesgo","constructor","onChange","e","setState","target","name","value","state","equipo","familia","toggleDataSeries","bind","dataSeries","visible","chart","render","tarjetas","props","filter","multiFilter","arr","filters","filterKeys","Object","keys","eachObj","every","eachKey","length","includes","newFilter","arrEquipos","map","unicosEquipos","Array","from","Set","arrFamilias","unicosFamilias","arrAbiertas","estado","arrCerradas","arrPorcentajePuntos","RI1","riesgoInicial","toLowerCase","RI2","RI3","RI4","RI5","nivelRiesgoInicial","RI1A","riesgoFinal","RI2A","RI3A","RI4A","RI5A","RI1B","RI2B","RI3B","RI4B","RI5B","nivelRiesgoFinal","console","log","reduccionRiesgo","toFixed","item","index"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport CanvasJSReact from \"../canvasjs.react\";\nimport { Label, Input } from \"reactstrap\";\nimport { Row, Col, Card, CardBody, Table } from \"reactstrap\";\nimport moment from \"moment\";\nvar CanvasJSChart = CanvasJSReact.CanvasJSChart;\nvar CanvasJS = CanvasJSReact.CanvasJS;\nexport class GraficoRiesgo extends Component {\n  constructor() {\n    super();\n    this.state = {\n      equipo: \"\",\n      familia: \"\",\n    };\n    this.toggleDataSeries = this.toggleDataSeries.bind(this);\n  }\n  toggleDataSeries(e) {\n    if (typeof e.dataSeries.visible === \"undefined\" || e.dataSeries.visible) {\n      e.dataSeries.visible = false;\n    } else {\n      e.dataSeries.visible = true;\n    }\n\n    this.chart.render();\n  }\n  onChange = (e) => {\n    this.setState({\n      [e.target.name]: e.target.value,\n    });\n  };\n\n  render() {\n    const { tarjetas } = this.props;\n\n    var filter = {\n      equipo: this.state.equipo && this.state.equipo,\n      familia: this.state.familia && this.state.familia,\n    };\n\n    const multiFilter = (arr, filters) => {\n      const filterKeys = Object.keys(filters);\n      return arr.filter((eachObj) => {\n        return filterKeys.every((eachKey) => {\n          if (!filters[eachKey].length) {\n            return true; // passing an empty filter means that filter is ignored.\n          }\n          return filters[eachKey].includes(eachObj[eachKey]);\n        });\n      });\n    };\n    const newFilter = multiFilter(tarjetas, filter);\n\n    const arrEquipos = tarjetas.map(({ equipo }) => equipo);\n    const unicosEquipos = Array.from(new Set(arrEquipos));\n\n    const arrFamilias = tarjetas.map(({ familia }) => familia);\n    const unicosFamilias = Array.from(new Set(arrFamilias));\n\n    // Formulas para \"Mapas de Riesgo\"\n\n    // Cantidad de tarjetas abiertas de newFilter\n\n    const arrAbiertas = newFilter.filter(({ estado }) => {\n      return estado === \"Abierta\";\n    });\n\n    const arrCerradas = newFilter.filter(({ estado }) => {\n      return estado === \"Cerrada\";\n    });\n\n    // Porcentaje de puntos tratados\n\n    const arrPorcentajePuntos = (arrCerradas.length * 100) / newFilter.length;\n\n    // Nivel Riesgo Inicial\n\n    // No significativo\n    const RI1 = newFilter.filter(({ riesgoInicial }) =>\n      riesgoInicial.toLowerCase().includes(\"NS: NO SIGNIFICATIVO\".toLowerCase())\n    ).length;\n\n    // Poco significativo\n    const RI2 =\n      newFilter.filter(({ riesgoInicial }) =>\n        riesgoInicial\n          .toLowerCase()\n          .includes(\"PS: POCO SIGNIFICATIVO\".toLowerCase())\n      ).length * 2;\n\n    // Moderado\n    const RI3 =\n      newFilter.filter(({ riesgoInicial }) =>\n        riesgoInicial.toLowerCase().includes(\"MO: MODERADO\".toLowerCase())\n      ).length * 3;\n\n    // Sigfificativo\n    const RI4 =\n      newFilter.filter(({ riesgoInicial }) =>\n        riesgoInicial.toLowerCase().includes(\"SI: SIGNIFICATIVO\".toLowerCase())\n      ).length * 4;\n\n    // Intolerable\n    const RI5 =\n      newFilter.filter(({ riesgoInicial }) =>\n        riesgoInicial.toLowerCase().includes(\"IN: INTOLERABLE\".toLowerCase())\n      ).length * 5;\n\n    const nivelRiesgoInicial = RI1 + RI2 + RI3 + RI4 + RI5;\n\n    // Nivel Riesgo Final\n\n    // No significativo\n    const RI1A = arrCerradas.filter(\n      ({ riesgoFinal }) =>\n        riesgoFinal.toLowerCase() === \"NS: NO SIGNIFICATIVO\".toLowerCase()\n    ).length;\n\n    // Poco significativo\n    const RI2A =\n      arrCerradas.filter(\n        ({ riesgoFinal }) =>\n          riesgoFinal.toLowerCase() === \"PS: POCO SIGNIFICATIVO\".toLowerCase()\n      ).length * 2;\n\n    // Moderado\n    const RI3A =\n      arrCerradas.filter(\n        ({ riesgoFinal }) =>\n          riesgoFinal.toLowerCase() === \"MO: MODERADO\".toLowerCase()\n      ).length * 3;\n\n    // Sigfificativo\n    const RI4A =\n      arrCerradas.filter(\n        ({ riesgoFinal }) =>\n          riesgoFinal.toLowerCase() === \"SI: SIGNIFICATIVO\".toLowerCase()\n      ).length * 4;\n\n    // Intolerable\n    const RI5A =\n      arrCerradas.filter(\n        ({ riesgoFinal }) =>\n          riesgoFinal.toLowerCase() === \"IN: INTOLERABLE\".toLowerCase()\n      ).length * 5;\n\n    // No significativo\n    const RI1B = arrAbiertas.filter(({ riesgoInicial }) =>\n      riesgoInicial.toLowerCase().includes(\"NS: NO SIGNIFICATIVO\".toLowerCase())\n    ).length;\n\n    // Poco significativo\n    const RI2B =\n      arrAbiertas.filter(({ riesgoInicial }) =>\n        riesgoInicial\n          .toLowerCase()\n          .includes(\"PS: POCO SIGNIFICATIVO\".toLowerCase())\n      ).length * 2;\n\n    // Moderado\n    const RI3B =\n      arrAbiertas.filter(({ riesgoInicial }) =>\n        riesgoInicial.toLowerCase().includes(\"MO: MODERADO\".toLowerCase())\n      ).length * 3;\n\n    // Sigfificativo\n    const RI4B =\n      arrAbiertas.filter(({ riesgoInicial }) =>\n        riesgoInicial.toLowerCase().includes(\"SI: SIGNIFICATIVO\".toLowerCase())\n      ).length * 4;\n\n    // Intolerable\n    const RI5B =\n      arrAbiertas.filter(({ riesgoInicial }) =>\n        riesgoInicial.toLowerCase().includes(\"IN: INTOLERABLE\".toLowerCase())\n      ).length * 5;\n\n    const nivelRiesgoFinal =\n      RI1A + RI2A + RI3A + RI4A + RI5A + RI1B + RI2B + RI3B + RI4B + RI5B;\n\n    console.log(\"+\");\n    console.log(RI1B);\n    console.log(\n      arrAbiertas.filter(({ riesgoInicial }) =>\n        riesgoInicial\n          .toLowerCase()\n          .includes(\"PS: POCO SIGNIFICATIVO\".toLowerCase())\n      )\n    );\n    console.log(RI3B);\n    console.log(RI4B);\n    console.log(RI5B);\n\n    const reduccionRiesgo =\n      ((nivelRiesgoInicial - nivelRiesgoFinal) / nivelRiesgoInicial) * 100;\n\n    return (\n      <div>\n        <Row>\n          <Col lg={8} md={12} sm={12}>\n            <Card>\n              <CardBody>\n                <h3>Tabla Mapas de riesgo</h3>\n                <Table className=\"no-wrap v-middle\" responsive>\n                  <thead>\n                    <tr className=\"border-0\">\n                      <th className=\"border-0\"></th>\n                    </tr>\n                  </thead>\n                  <tbody>\n                    <tr>\n                      <td>Tarjetas abiertas | | Tarjetas cerradas</td>\n                      <td>\n                        {newFilter.length} | | {arrCerradas.length}\n                      </td>\n                    </tr>\n                    <tr>\n                      <td>\n                        Porcentaje de puntos tratados (% de tarjetas cerradas)\n                      </td>\n                      <td>{arrPorcentajePuntos.toFixed(2)} %</td>\n                    </tr>\n                    <tr>\n                      <td>Nivel Riesgo Inicial</td>\n                      <td>{nivelRiesgoInicial}</td>\n                    </tr>\n                    <tr>\n                      <td>Nivel Riesgo Final</td>\n                      <td>{nivelRiesgoFinal}</td>\n                    </tr>\n                    <tr>\n                      <td>% de Reducción de Riesgo </td>\n                      <td>{reduccionRiesgo.toFixed(2)} %</td>\n                    </tr>\n                  </tbody>\n                </Table>\n              </CardBody>\n            </Card>\n          </Col>\n          <Col lg={4} md={12} sm={12}>\n            <Card>\n              <CardBody>\n                <h3>Filtros</h3>\n                <Label for=\"equipo\">Equipo</Label>\n                <Input\n                  type=\"select\"\n                  name=\"equipo\"\n                  id=\"equipo\"\n                  onChange={this.onChange}\n                >\n                  <option></option>\n                  {unicosEquipos.map((item, index) => {\n                    return <option key={index}>{item}</option>;\n                  })}\n                </Input>\n                <Label for=\"equipo\" className=\"mt-3\">\n                  Familia\n                </Label>\n                <Input\n                  type=\"select\"\n                  name=\"familia\"\n                  id=\"familia\"\n                  onChange={this.onChange}\n                >\n                  <option></option>\n                  {unicosFamilias.map((item, index) => {\n                    return <option key={index}>{item}</option>;\n                  })}\n                </Input>\n              </CardBody>\n            </Card>\n          </Col>\n        </Row>\n      </div>\n    );\n  }\n}\n\nexport default GraficoRiesgo;\n"]},"metadata":{},"sourceType":"module"}