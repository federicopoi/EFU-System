{"ast":null,"code":"var _jsxFileName = \"/Users/fedepoi/tpm-project-mern/client/src/components/dasboard/tarjetasverdes/GraficoVerdes.jsx\";\nimport React, { Component } from \"react\";\nimport CanvasJSReact from \"../canvasjs.react\";\nvar CanvasJSChart = CanvasJSReact.CanvasJSChart;\nvar CanvasJS = CanvasJSReact.CanvasJS;\nexport class GraficoVerdes extends Component {\n  constructor() {\n    super();\n    this.toggleDataSeries = this.toggleDataSeries.bind(this);\n  }\n\n  toggleDataSeries(e) {\n    if (typeof e.dataSeries.visible === \"undefined\" || e.dataSeries.visible) {\n      e.dataSeries.visible = false;\n    } else {\n      e.dataSeries.visible = true;\n    }\n\n    this.chart.render();\n  }\n\n  render() {\n    const {\n      tarjetas\n    } = this.props;\n\n    function dateRange(startDate, endDate) {\n      var start = startDate.split(\"-\");\n      var end = endDate.split(\"-\");\n      var startYear = parseInt(start[0]);\n      var endYear = parseInt(end[0]);\n      var dates = [];\n\n      for (var i = startYear; i <= endYear; i++) {\n        var endMonth = i != endYear ? 11 : parseInt(end[1]) - 1;\n        var startMon = i === startYear ? parseInt(start[1]) - 1 : 0;\n\n        for (var j = startMon; j <= endMonth; j = j > 12 ? j % 12 || 11 : j + 1) {\n          var month = j + 1;\n          var displayMonth = month < 10 ? \"0\" + month : month;\n          dates.push([i, displayMonth].join(\"-\"));\n        }\n      }\n\n      return dates;\n    } // Formulas para \"Verdes acumuladas abiertas\"\n    // Filtro todos los meses en el que hay tarjetas abiertas Verdes\n\n\n    const fechasTarjetasVerdes = tarjetas.filter(({\n      estado,\n      color\n    }) => color === \"Verde\").map(({\n      fecha\n    }) => fecha.substr(0, 7)); // Filtro todos los meses en el que hay tarjetas cerradas Verdes\n\n    const fechasTarjetasVerdesCerradas = tarjetas.filter(({\n      estado,\n      color\n    }) => estado === \"Cerrada\" && color === \"Verde\").map(({\n      finReparacion\n    }) => finReparacion.substr(0, 7)); // Borro todos los meses repetidos\n\n    let fechasTarjetasVerdes1 = new Set(fechasTarjetasVerdes);\n    const fechasTarjetasVerdesUnicas = [...fechasTarjetasVerdes1]; // Borro todos los meses repetidos\n\n    let fechasTarjetasVerdes1Cerradas = new Set(fechasTarjetasVerdesCerradas);\n    const fechasTarjetasVerdesUnicasCerradas = [...fechasTarjetasVerdes1Cerradas];\n    var c = fechasTarjetasVerdesUnicas.concat(fechasTarjetasVerdesUnicasCerradas);\n    var fechastarjetasUnicas = c.filter((item, pos) => c.indexOf(item) === pos);\n    console.log(fechastarjetasUnicas.sort().slice(-1).pop()); // Numero total de tarjetas de cada mes (no acumulado)\n\n    let array = fechastarjetasUnicas.sort().map((item, index) => {\n      return tarjetas.filter(({\n        estado,\n        fecha,\n        color\n      }) => color === \"Verde\" && fecha.substr(4, 4).replace(\"-\", \"\").replace(\"-\", \"\") === item.slice(5, 7)).length;\n    });\n    const arrTarjetasVerdesAcumuladas = array.map((elem, index) => array.slice(0, index + 1).reduce((a, b) => a + b)); // Datos para el grafico\n\n    const VerdesAcumuladasAbiertasData = [fechastarjetasUnicas.sort().map((item, index) => {\n      return {\n        x: new Date(parseInt(item.slice(0, 4)), parseInt(item.slice(5, 7) - 1)),\n        y: arrTarjetasVerdesAcumuladas[index]\n      };\n    })]; // Formulas para \"Verdes acumuladas cerradas\"\n    // Numero total de tarjetas de cada mes (no acumulado)\n\n    let arrayCerradas = fechastarjetasUnicas.sort().map((item, index) => {\n      return tarjetas.filter(({\n        estado,\n        finReparacion,\n        color\n      }) => color === \"Verde\" && estado === \"Cerrada\" && finReparacion.substr(4, 4).replace(\"-\", \"\").replace(\"-\", \"\") === item.slice(5, 7)).length;\n    }); // Acumulado de tarjetas por mes\n\n    const arrTarjetasVerdesAcumuladasCerradas = arrayCerradas.map((elem, index) => arrayCerradas.slice(0, index + 1).reduce((aa, bb) => aa + bb)); // Datos para el grafico\n\n    const VerdesAcumuladasAbiertasDataCerradas = [fechastarjetasUnicas.sort().map((item, index) => {\n      return {\n        x: new Date(parseInt(item.slice(0, 4)), parseInt(item.slice(5, 7) - 1)),\n        y: arrTarjetasVerdesAcumuladasCerradas[index]\n      };\n    })]; // Formulas para \"Porcentaje acumuladas cerradas porcentaje\"\n    // Numero total de tarjetas de cada mes (no acumulado)\n\n    let arrayCerradasPorcentaje = fechastarjetasUnicas.sort().map((item, index) => {\n      return tarjetas.filter(({\n        estado,\n        finReparacion,\n        color\n      }) => color === \"Verde\" && estado === \"Cerrada\" && finReparacion.substr(4, 4).replace(\"-\", \"\").replace(\"-\", \"\") === item.slice(5, 7)).length;\n    }); // Acumulado de tarjetas por mes\n\n    const arrTarjetasVerdesAcumuladasCerradasPorcentaje = arrayCerradasPorcentaje.map((elem, index) => arrayCerradasPorcentaje.slice(0, index + 1).reduce((aa, bb) => aa + bb)); // Datos para el grafico de cerradas porcentaje\n\n    const VerdesAcumuladasAbiertasDataCerradasPorcentaje = [fechastarjetasUnicas.map((item, index) => {\n      return {\n        x: new Date(parseInt(item.slice(0, 4)), parseInt(item.slice(5, 7) - 1)),\n        y: arrTarjetasVerdesAcumuladasCerradasPorcentaje[index] / arrTarjetasVerdesAcumuladas[index] * 100\n      };\n    })];\n    CanvasJS.addCultureInfo(\"es\", {\n      decimalSeparator: \",\",\n      // Observe ToolTip Number Format\n      digitGroupSeparator: \".\",\n      // Observe axisY labels\n      months: [\"Enero\", \"Febrero\", \"Marzo\", \"Abril\", \"Mayo\", \"Junio\", \"Julio\", \"Agosto\", \"Septiembre\", \"Octubre\", \"Noviembre\", \"Diciembre\"]\n    });\n    const options = {\n      culture: \"es\",\n      animationEnabled: true,\n      culture: \"es\",\n      axisX: {\n        valueFormatString: \"MMMM\",\n        interval: 1,\n        intervalType: \"month\"\n      },\n      axisY: {\n        title: \"Cantidad de tarjetas\",\n        lineColor: \"#000000\",\n        tickColor: \"#000000\",\n        labelFontColor: \"#000000\"\n      },\n      axisY2: {\n        title: \"% de Cierre\",\n        suffix: \"%\",\n        lineColor: \"#000000\",\n        tickColor: \"#000000\",\n        labelFontColor: \"#000000\"\n      },\n      toolTip: {\n        shared: true\n      },\n      legend: {\n        cursor: \"pointer\",\n        itemclick: this.toggleDataSeries,\n        verticalAlign: \"top\"\n      },\n      data: [{\n        color: \"#28a745\",\n        type: \"column\",\n        name: \"Verdes acumuladas (abiertas)\",\n        showInLegend: true,\n        xValueFormatString: \"MMMM YYYY\",\n        dataPoints: VerdesAcumuladasAbiertasData[0]\n      }, {\n        type: \"line\",\n        name: \"Verdes acumuladas (cerradas)\",\n        showInLegend: true,\n        dataPoints: VerdesAcumuladasAbiertasDataCerradas[0]\n      }, {\n        type: \"line\",\n        color: \"#121212\",\n        name: \"Porcentaje Verdes Cerradas\",\n        showInLegend: true,\n        axisYType: \"secondary\",\n        yValueFormatString: \"#,##0\",\n        dataPoints: VerdesAcumuladasAbiertasDataCerradasPorcentaje[0]\n      }]\n    };\n    return /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 248,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(CanvasJSChart, {\n      culture: \"en\",\n      options: options,\n      onRef: ref => this.chart = ref,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 249,\n        columnNumber: 9\n      }\n    }));\n  }\n\n}\nexport default GraficoVerdes;","map":{"version":3,"sources":["/Users/fedepoi/tpm-project-mern/client/src/components/dasboard/tarjetasverdes/GraficoVerdes.jsx"],"names":["React","Component","CanvasJSReact","CanvasJSChart","CanvasJS","GraficoVerdes","constructor","toggleDataSeries","bind","e","dataSeries","visible","chart","render","tarjetas","props","dateRange","startDate","endDate","start","split","end","startYear","parseInt","endYear","dates","i","endMonth","startMon","j","month","displayMonth","push","join","fechasTarjetasVerdes","filter","estado","color","map","fecha","substr","fechasTarjetasVerdesCerradas","finReparacion","fechasTarjetasVerdes1","Set","fechasTarjetasVerdesUnicas","fechasTarjetasVerdes1Cerradas","fechasTarjetasVerdesUnicasCerradas","c","concat","fechastarjetasUnicas","item","pos","indexOf","console","log","sort","slice","pop","array","index","replace","length","arrTarjetasVerdesAcumuladas","elem","reduce","a","b","VerdesAcumuladasAbiertasData","x","Date","y","arrayCerradas","arrTarjetasVerdesAcumuladasCerradas","aa","bb","VerdesAcumuladasAbiertasDataCerradas","arrayCerradasPorcentaje","arrTarjetasVerdesAcumuladasCerradasPorcentaje","VerdesAcumuladasAbiertasDataCerradasPorcentaje","addCultureInfo","decimalSeparator","digitGroupSeparator","months","options","culture","animationEnabled","axisX","valueFormatString","interval","intervalType","axisY","title","lineColor","tickColor","labelFontColor","axisY2","suffix","toolTip","shared","legend","cursor","itemclick","verticalAlign","data","type","name","showInLegend","xValueFormatString","dataPoints","axisYType","yValueFormatString","ref"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport CanvasJSReact from \"../canvasjs.react\";\nvar CanvasJSChart = CanvasJSReact.CanvasJSChart;\nvar CanvasJS = CanvasJSReact.CanvasJS;\nexport class GraficoVerdes extends Component {\n  constructor() {\n    super();\n    this.toggleDataSeries = this.toggleDataSeries.bind(this);\n  }\n  toggleDataSeries(e) {\n    if (typeof e.dataSeries.visible === \"undefined\" || e.dataSeries.visible) {\n      e.dataSeries.visible = false;\n    } else {\n      e.dataSeries.visible = true;\n    }\n    this.chart.render();\n  }\n\n  render() {\n    const { tarjetas } = this.props;\n\n    function dateRange(startDate, endDate) {\n      var start = startDate.split(\"-\");\n      var end = endDate.split(\"-\");\n      var startYear = parseInt(start[0]);\n      var endYear = parseInt(end[0]);\n      var dates = [];\n\n      for (var i = startYear; i <= endYear; i++) {\n        var endMonth = i != endYear ? 11 : parseInt(end[1]) - 1;\n        var startMon = i === startYear ? parseInt(start[1]) - 1 : 0;\n        for (\n          var j = startMon;\n          j <= endMonth;\n          j = j > 12 ? j % 12 || 11 : j + 1\n        ) {\n          var month = j + 1;\n          var displayMonth = month < 10 ? \"0\" + month : month;\n          dates.push([i, displayMonth].join(\"-\"));\n        }\n      }\n      return dates;\n    }\n\n    // Formulas para \"Verdes acumuladas abiertas\"\n\n    // Filtro todos los meses en el que hay tarjetas abiertas Verdes\n    const fechasTarjetasVerdes = tarjetas\n      .filter(({ estado, color }) => color === \"Verde\")\n      .map(({ fecha }) => fecha.substr(0, 7));\n\n    // Filtro todos los meses en el que hay tarjetas cerradas Verdes\n    const fechasTarjetasVerdesCerradas = tarjetas\n      .filter(({ estado, color }) => estado === \"Cerrada\" && color === \"Verde\")\n      .map(({ finReparacion }) => finReparacion.substr(0, 7));\n\n    // Borro todos los meses repetidos\n    let fechasTarjetasVerdes1 = new Set(fechasTarjetasVerdes);\n    const fechasTarjetasVerdesUnicas = [...fechasTarjetasVerdes1];\n\n    // Borro todos los meses repetidos\n    let fechasTarjetasVerdes1Cerradas = new Set(fechasTarjetasVerdesCerradas);\n    const fechasTarjetasVerdesUnicasCerradas = [\n      ...fechasTarjetasVerdes1Cerradas,\n    ];\n\n    var c = fechasTarjetasVerdesUnicas.concat(\n      fechasTarjetasVerdesUnicasCerradas\n    );\n    var fechastarjetasUnicas = c.filter((item, pos) => c.indexOf(item) === pos);\n\n    console.log(fechastarjetasUnicas.sort().slice(-1).pop());\n\n    // Numero total de tarjetas de cada mes (no acumulado)\n    let array = fechastarjetasUnicas.sort().map((item, index) => {\n      return tarjetas.filter(\n        ({ estado, fecha, color }) =>\n          color === \"Verde\" &&\n          fecha.substr(4, 4).replace(\"-\", \"\").replace(\"-\", \"\") ===\n            item.slice(5, 7)\n      ).length;\n    });\n\n    const arrTarjetasVerdesAcumuladas = array.map((elem, index) =>\n      array.slice(0, index + 1).reduce((a, b) => a + b)\n    );\n\n    // Datos para el grafico\n    const VerdesAcumuladasAbiertasData = [\n      fechastarjetasUnicas.sort().map((item, index) => {\n        return {\n          x: new Date(\n            parseInt(item.slice(0, 4)),\n            parseInt(item.slice(5, 7) - 1)\n          ),\n          y: arrTarjetasVerdesAcumuladas[index],\n        };\n      }),\n    ];\n\n    // Formulas para \"Verdes acumuladas cerradas\"\n\n    // Numero total de tarjetas de cada mes (no acumulado)\n    let arrayCerradas = fechastarjetasUnicas.sort().map((item, index) => {\n      return tarjetas.filter(\n        ({ estado, finReparacion, color }) =>\n          color === \"Verde\" &&\n          estado === \"Cerrada\" &&\n          finReparacion.substr(4, 4).replace(\"-\", \"\").replace(\"-\", \"\") ===\n            item.slice(5, 7)\n      ).length;\n    });\n\n    // Acumulado de tarjetas por mes\n    const arrTarjetasVerdesAcumuladasCerradas = arrayCerradas.map(\n      (elem, index) =>\n        arrayCerradas.slice(0, index + 1).reduce((aa, bb) => aa + bb)\n    );\n\n    // Datos para el grafico\n    const VerdesAcumuladasAbiertasDataCerradas = [\n      fechastarjetasUnicas.sort().map((item, index) => {\n        return {\n          x: new Date(\n            parseInt(item.slice(0, 4)),\n            parseInt(item.slice(5, 7) - 1)\n          ),\n          y: arrTarjetasVerdesAcumuladasCerradas[index],\n        };\n      }),\n    ];\n\n    // Formulas para \"Porcentaje acumuladas cerradas porcentaje\"\n\n    // Numero total de tarjetas de cada mes (no acumulado)\n    let arrayCerradasPorcentaje = fechastarjetasUnicas\n      .sort()\n      .map((item, index) => {\n        return tarjetas.filter(\n          ({ estado, finReparacion, color }) =>\n            color === \"Verde\" &&\n            estado === \"Cerrada\" &&\n            finReparacion.substr(4, 4).replace(\"-\", \"\").replace(\"-\", \"\") ===\n              item.slice(5, 7)\n        ).length;\n      });\n\n    // Acumulado de tarjetas por mes\n    const arrTarjetasVerdesAcumuladasCerradasPorcentaje = arrayCerradasPorcentaje.map(\n      (elem, index) =>\n        arrayCerradasPorcentaje.slice(0, index + 1).reduce((aa, bb) => aa + bb)\n    );\n    // Datos para el grafico de cerradas porcentaje\n\n    const VerdesAcumuladasAbiertasDataCerradasPorcentaje = [\n      fechastarjetasUnicas.map((item, index) => {\n        return {\n          x: new Date(\n            parseInt(item.slice(0, 4)),\n            parseInt(item.slice(5, 7) - 1)\n          ),\n          y:\n            (arrTarjetasVerdesAcumuladasCerradasPorcentaje[index] /\n              arrTarjetasVerdesAcumuladas[index]) *\n            100,\n        };\n      }),\n    ];\n\n    CanvasJS.addCultureInfo(\"es\", {\n      decimalSeparator: \",\", // Observe ToolTip Number Format\n      digitGroupSeparator: \".\", // Observe axisY labels\n\n      months: [\n        \"Enero\",\n        \"Febrero\",\n        \"Marzo\",\n        \"Abril\",\n        \"Mayo\",\n        \"Junio\",\n        \"Julio\",\n        \"Agosto\",\n        \"Septiembre\",\n        \"Octubre\",\n        \"Noviembre\",\n        \"Diciembre\",\n      ],\n    });\n    const options = {\n      culture: \"es\",\n      animationEnabled: true,\n      culture: \"es\",\n      axisX: {\n        valueFormatString: \"MMMM\",\n\n        interval: 1,\n        intervalType: \"month\",\n      },\n      axisY: {\n        title: \"Cantidad de tarjetas\",\n        lineColor: \"#000000\",\n        tickColor: \"#000000\",\n        labelFontColor: \"#000000\",\n      },\n      axisY2: {\n        title: \"% de Cierre\",\n        suffix: \"%\",\n        lineColor: \"#000000\",\n        tickColor: \"#000000\",\n        labelFontColor: \"#000000\",\n      },\n      toolTip: {\n        shared: true,\n      },\n      legend: {\n        cursor: \"pointer\",\n        itemclick: this.toggleDataSeries,\n        verticalAlign: \"top\",\n      },\n      data: [\n        {\n          color: \"#28a745\",\n          type: \"column\",\n          name: \"Verdes acumuladas (abiertas)\",\n          showInLegend: true,\n          xValueFormatString: \"MMMM YYYY\",\n          dataPoints: VerdesAcumuladasAbiertasData[0],\n        },\n        {\n          type: \"line\",\n          name: \"Verdes acumuladas (cerradas)\",\n          showInLegend: true,\n          dataPoints: VerdesAcumuladasAbiertasDataCerradas[0],\n        },\n        {\n          type: \"line\",\n          color: \"#121212\",\n          name: \"Porcentaje Verdes Cerradas\",\n          showInLegend: true,\n          axisYType: \"secondary\",\n          yValueFormatString: \"#,##0\",\n          dataPoints: VerdesAcumuladasAbiertasDataCerradasPorcentaje[0],\n        },\n      ],\n    };\n\n    return (\n      <div>\n        <CanvasJSChart\n          culture=\"en\"\n          options={options}\n          onRef={(ref) => (this.chart = ref)}\n        />\n      </div>\n    );\n  }\n}\n\nexport default GraficoVerdes;\n"]},"metadata":{},"sourceType":"module"}