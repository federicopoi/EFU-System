{"ast":null,"code":"var _jsxFileName = \"/Users/fedepoi/klockner_tpm/client/src/components/dasboard/tarjetasamarillas/GraficoAmarillas.jsx\";\nimport React, { Component } from \"react\";\nimport CanvasJSReact from \"../canvasjs.react\";\nimport moment, { months } from \"moment\";\nimport TableModal from \"../tablemodal/TableModal\";\nimport { Col, Row, Card, CardBody, Table, Input } from \"reactstrap\";\nimport MoreVertIcon from \"@material-ui/icons/MoreVert\";\nvar CanvasJSChart = CanvasJSReact.CanvasJSChart;\nvar CanvasJS = CanvasJSReact.CanvasJS;\nexport class GraficoAmarillas extends Component {\n  constructor() {\n    super();\n\n    this.onChange = e => {\n      e.target.value === \"\" ? this.setState({\n        [e.target.name]: 12\n      }) : this.setState({\n        [e.target.name]: e.target.value\n      });\n    };\n\n    this.state = {\n      numberMonths: \"12\"\n    };\n    this.toggleDataSeries = this.toggleDataSeries.bind(this);\n  }\n\n  toggleDataSeries(e) {\n    if (typeof e.dataSeries.visible === \"undefined\" || e.dataSeries.visible) {\n      e.dataSeries.visible = false;\n    } else {\n      e.dataSeries.visible = true;\n    }\n\n    this.chart.render();\n  }\n\n  render() {\n    const {\n      tarjetas\n    } = this.props;\n    console.log(this.state); // Formulas para \"Amarillas acumuladas abiertas\"\n    // Filtro todos los meses en el que hay tarjetas abiertas Amarillas\n\n    const fechasTarjetasAmarillas = tarjetas.filter(({\n      estado,\n      color\n    }) => color === \"Amarilla\").map(({\n      fecha\n    }) => fecha.substr(0, 7)); // Filtro todos los meses en el que hay tarjetas cerradas Amarillas\n\n    const fechasTarjetasAmarillasCerradas = tarjetas.filter(({\n      estado,\n      color\n    }) => estado === \"Cerrada\" && color === \"Amarilla\").map(({\n      finReparacion\n    }) => finReparacion.substr(0, 7)); // Borro todos los meses repetidos\n\n    let fechasTarjetasAmarillas1 = new Set(fechasTarjetasAmarillas);\n    const fechasTarjetasAmarillasUnicas = [...fechasTarjetasAmarillas1]; // Borro todos los meses repetidos\n\n    let fechasTarjetasAmarillas1Cerradas = new Set(fechasTarjetasAmarillasCerradas);\n    const fechasTarjetasAmarillasUnicasCerradas = [...fechasTarjetasAmarillas1Cerradas];\n    var c = fechasTarjetasAmarillasUnicas.concat(fechasTarjetasAmarillasUnicasCerradas);\n    var fechastarjetasUnicas = c.filter((item, pos) => c.indexOf(item) === pos);\n    const startDate = moment(fechastarjetasUnicas.sort()[0]);\n    const endDate = moment(fechastarjetasUnicas.sort().slice(-1)[1]);\n    const fechastarjetasUnicasRango = [];\n\n    if (endDate.isBefore(startDate)) {\n      throw \"End date must be greated than start date.\";\n    }\n\n    while (startDate.isBefore(endDate)) {\n      fechastarjetasUnicasRango.push(startDate.format(\"YYYY-MM\"));\n      startDate.add(1, \"month\");\n    }\n\n    const fechastarjetasUnicasRangoCut = fechastarjetasUnicasRango.slice(Math.max(fechastarjetasUnicasRango.length - this.state.numberMonths, 1)); // Numero total de tarjetas de cada mes (no acumulado)\n\n    let array = fechastarjetasUnicasRangoCut.sort().map((item, index) => {\n      return tarjetas.filter(({\n        estado,\n        fecha,\n        color\n      }) => color === \"Amarilla\" && fecha.slice(0, 7) === item.slice(0, 7)).length;\n    });\n    const arrTarjetasAmarillasAcumuladas = array.map((elem, index) => array.slice(0, index + 1).reduce((a, b) => a + b)); // Datos para el grafico\n\n    const AmarillasAcumuladasAbiertasData = [fechastarjetasUnicasRangoCut.sort().map((item, index) => {\n      return {\n        x: new Date(parseInt(item.slice(0, 4)), parseInt(item.slice(5, 7) - 1)),\n        y: arrTarjetasAmarillasAcumuladas[index]\n      };\n    })]; // Formulas para \"Amarillas acumuladas cerradas\"\n    // Numero total de tarjetas de cada mes (no acumulado)\n\n    let arrayCerradas = fechastarjetasUnicasRangoCut.sort().map((item, index) => {\n      return tarjetas.filter(({\n        estado,\n        finReparacion,\n        color\n      }) => color === \"Amarilla\" && estado === \"Cerrada\" && finReparacion.slice(0, 7) === item.slice(0, 7)).length;\n    }); // Acumulado de tarjetas por mes\n\n    const arrTarjetasAmarillasAcumuladasCerradas = arrayCerradas.map((elem, index) => arrayCerradas.slice(0, index + 1).reduce((aa, bb) => aa + bb)); // Datos para el grafico\n\n    const AmarillasAcumuladasAbiertasDataCerradas = [fechastarjetasUnicasRangoCut.sort().map((item, index) => {\n      return {\n        x: new Date(parseInt(item.slice(0, 4)), parseInt(item.slice(5, 7) - 1)),\n        y: arrTarjetasAmarillasAcumuladasCerradas[index]\n      };\n    })]; // Formulas para \"Porcentaje acumuladas cerradas porcentaje\"\n    // Numero total de tarjetas de cada mes (no acumulado)\n\n    let arrayCerradasPorcentaje = fechastarjetasUnicasRangoCut.sort().map((item, index) => {\n      return tarjetas.filter(({\n        estado,\n        finReparacion,\n        color\n      }) => color === \"Amarilla\" && estado === \"Cerrada\" && finReparacion.slice(0, 7) === item.slice(0, 7)).length;\n    }); // Acumulado de tarjetas por mes\n\n    const arrTarjetasAmarillasAcumuladasCerradasPorcentaje = arrayCerradasPorcentaje.map((elem, index) => arrayCerradasPorcentaje.slice(0, index + 1).reduce((aa, bb) => aa + bb)); // Datos para el grafico de cerradas porcentaje\n\n    const AmarillasAcumuladasAbiertasDataCerradasPorcentaje = [fechastarjetasUnicasRangoCut.map((item, index) => {\n      return {\n        x: new Date(parseInt(item.slice(0, 4)), parseInt(item.slice(5, 7) - 1)),\n        y: arrTarjetasAmarillasAcumuladasCerradasPorcentaje[index] / arrTarjetasAmarillasAcumuladas[index] * 100\n      };\n    })];\n    const arrayMonths = [1, 5, 10, 15];\n    CanvasJS.addCultureInfo(\"es\", {\n      decimalSeparator: \".\",\n      digitGroupSeparator: \",\",\n      months: [\"Enero\", \"Febrero\", \"Marzo\", \"Abril\", \"Mayo\", \"Junio\", \"Julio\", \"Agosto\", \"Septiembre\", \"Octubre\", \"Noviembre\", \"Diciembre\"]\n    });\n    const options = {\n      culture: \"es\",\n      animationEnabled: true,\n      axisX: {\n        valueFormatString: \"MMMM\",\n        interval: 1,\n        intervalType: \"month\"\n      },\n      axisY: {\n        title: \"Cantidad de tarjetas\",\n        lineColor: \"#000000\",\n        tickColor: \"#000000\",\n        labelFontColor: \"#000000\"\n      },\n      axisY2: {\n        title: \"% de Cierre\",\n        suffix: \"%\",\n        lineColor: \"#000000\",\n        tickColor: \"#000000\",\n        labelFontColor: \"#000000\"\n      },\n      toolTip: {\n        shared: true\n      },\n      legend: {\n        cursor: \"pointer\",\n        itemclick: this.toggleDataSeries,\n        verticalAlign: \"top\"\n      },\n      data: [{\n        color: \"#F7E91B\",\n        type: \"column\",\n        name: \"Amarillas acumuladas (abiertas)\",\n        showInLegend: true,\n        xValueFormatString: \"MMMM YYYY\",\n        dataPoints: AmarillasAcumuladasAbiertasData[0]\n      }, {\n        type: \"line\",\n        name: \"Amarillas acumuladas (cerradas)\",\n        showInLegend: true,\n        dataPoints: AmarillasAcumuladasAbiertasDataCerradas[0]\n      }, {\n        type: \"line\",\n        color: \"#121212\",\n        name: \"Porcentaje Amarillas Cerradas\",\n        showInLegend: true,\n        axisYType: \"secondary\",\n        yValueFormatString: \"#,##0\",\n        dataPoints: AmarillasAcumuladasAbiertasDataCerradasPorcentaje[0]\n      }]\n    };\n    return /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 262,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(Row, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 263,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(Col, {\n      lg: 5,\n      md: 12,\n      sm: 12,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 264,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(Card, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 265,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(CardBody, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 266,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"d-sm-flex align-items-center\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 267,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 268,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 269,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"h3\", {\n      className: \"mb-3\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 270,\n        columnNumber: 23\n      }\n    }, \"Evolucion de Tarjetas amarillas\"))), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"ml-auto d-sm-flex no-block align-items-center mb-3\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 273,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(Col, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 274,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      class: \"dropdown\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 275,\n        columnNumber: 23\n      }\n    }, /*#__PURE__*/React.createElement(Button, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 276,\n        columnNumber: 25\n      }\n    }, \"Opciones\"), /*#__PURE__*/React.createElement(\"div\", {\n      class: \"dropdown-content\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 277,\n        columnNumber: 25\n      }\n    }, estado === \"Abierta\" && color !== \"Amarilla\" && /*#__PURE__*/React.createElement(Col, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 279,\n        columnNumber: 29\n      }\n    }, /*#__PURE__*/React.createElement(CerrarTarjetaModal, {\n      _id: link_id,\n      color: color,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 280,\n        columnNumber: 31\n      }\n    })), estado === \"Abierta\" && color === \"Amarilla\" && /*#__PURE__*/React.createElement(Col, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 287,\n        columnNumber: 29\n      }\n    }, /*#__PURE__*/React.createElement(CerrarTarjetaAmarillaModal, {\n      _id: link_id,\n      color: color,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 288,\n        columnNumber: 31\n      }\n    })), /*#__PURE__*/React.createElement(Col, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 294,\n        columnNumber: 27\n      }\n    }, /*#__PURE__*/React.createElement(QRModal, {\n      path: this.props.location.pathname,\n      color: color,\n      numero: numero,\n      completePath: completeLink,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 295,\n        columnNumber: 29\n      }\n    }, \"Mostrar QR\")), imagen[0] === undefined && /*#__PURE__*/React.createElement(Col, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 305,\n        columnNumber: 29\n      }\n    }, /*#__PURE__*/React.createElement(UploadImageModal, {\n      p: true,\n      button: false,\n      _id: link_id,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 306,\n        columnNumber: 31\n      }\n    })), localStorage.token && this.props.user && this.props.user.role === \"Jefe de area\" && color !== \"Amarilla\" && /*#__PURE__*/React.createElement(Col, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 318,\n        columnNumber: 31\n      }\n    }, /*#__PURE__*/React.createElement(EditarTarjetaModal, {\n      tarjeta: {\n        numero,\n        descripcion,\n        prioridad,\n        familia,\n        fecha,\n        maquina,\n        estado,\n        equipo,\n        sugerencia,\n        detecto,\n        tipodeRiesgo,\n        riesgoInicial,\n        color,\n        inicioReparacion,\n        finReparacion,\n        responsable,\n        riesgoFinal,\n        tiempoEmpleado,\n        causa,\n        tareaRealizada,\n        tipoAccion,\n        materialUtilizado,\n        _id\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 319,\n        columnNumber: 33\n      }\n    })), localStorage.token && this.props.user && this.props.user.role === \"Jefe de area\" && color === \"Amarilla\" && /*#__PURE__*/React.createElement(Col, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 352,\n        columnNumber: 31\n      }\n    }, /*#__PURE__*/React.createElement(EditarTarjetaModalAmarilla, {\n      tarjeta: {\n        _id,\n        descripcion,\n        detecto,\n        prioridad,\n        maquina,\n        familia,\n        equipo,\n        sustoExperimentado,\n        sustoObservado,\n        impactoAmbiente,\n        sugerencia,\n        tipodeRiesgo,\n        riesgoInicial,\n        responsable,\n        estado,\n        tareaRealizada,\n        riesgoFinal,\n        tipoAccion,\n        accionesComplementarias\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 353,\n        columnNumber: 33\n      }\n    })), localStorage.token && this.props.user && this.props.user.role === \"Admin\" && color !== \"Amarilla\" && /*#__PURE__*/React.createElement(Col, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 382,\n        columnNumber: 31\n      }\n    }, /*#__PURE__*/React.createElement(EditarTarjetaModal, {\n      tarjeta: {\n        numero,\n        descripcion,\n        prioridad,\n        familia,\n        fecha,\n        maquina,\n        estado,\n        equipo,\n        sugerencia,\n        detecto,\n        tipodeRiesgo,\n        riesgoInicial,\n        color,\n        inicioReparacion,\n        finReparacion,\n        responsable,\n        riesgoFinal,\n        tiempoEmpleado,\n        causa,\n        tareaRealizada,\n        tipoAccion,\n        materialUtilizado,\n        _id\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 383,\n        columnNumber: 33\n      }\n    })), localStorage.token && this.props.user && this.props.user.role === \"Admin\" && color === \"Amarilla\" && /*#__PURE__*/React.createElement(Col, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 416,\n        columnNumber: 31\n      }\n    }, /*#__PURE__*/React.createElement(EditarTarjetaModalAmarilla, {\n      tarjeta: {\n        _id,\n        descripcion,\n        detecto,\n        prioridad,\n        maquina,\n        familia,\n        equipo,\n        sustoExperimentado,\n        sustoObservado,\n        impactoAmbiente,\n        sugerencia,\n        tipodeRiesgo,\n        riesgoInicial,\n        responsable,\n        estado,\n        tareaRealizada,\n        riesgoFinal,\n        tipoAccion,\n        accionesComplementarias\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 417,\n        columnNumber: 33\n      }\n    })), plan[0] === false && /*#__PURE__*/React.createElement(PlanificacionModal, {\n      _id: link_id,\n      p: true,\n      button: false,\n      tarjeta: {\n        previstaCierre,\n        responsableSeguimiento,\n        recursos,\n        materiales,\n        solicitudCompras,\n        comprometidaCompras,\n        tareaRealizar,\n        responsableTarea,\n        comentario1,\n        comentario2,\n        comentario3\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 443,\n        columnNumber: 29\n      }\n    }), localStorage.token && this.props.user && this.props.user.role === \"Admin\" && /*#__PURE__*/React.createElement(Col, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 466,\n        columnNumber: 31\n      }\n    }, /*#__PURE__*/React.createElement(\"p\", {\n      \"text-color\": \"danger\",\n      onClick: this.onDeleteClick.bind(this, _id),\n      style: {\n        cursor: \"pointer\"\n      },\n      className: \"my-3\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 467,\n        columnNumber: 33\n      }\n    }, \"Borrar Tarjeta\")))), /*#__PURE__*/React.createElement(MoreVertIcon, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 479,\n        columnNumber: 23\n      }\n    })))), /*#__PURE__*/React.createElement(CanvasJSChart, {\n      culture: \"en\",\n      options: options,\n      onRef: ref => this.chart = ref,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 484,\n        columnNumber: 17\n      }\n    }), /*#__PURE__*/React.createElement(Input, {\n      type: \"number\",\n      name: \"numberMonths\",\n      id: \"numberMonths\",\n      className: \"mt-2\",\n      onChange: this.onChange,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 489,\n        columnNumber: 17\n      }\n    })))), /*#__PURE__*/React.createElement(Col, {\n      lg: 7,\n      md: 12,\n      sm: 12,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 499,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(TableModal, {\n      tarjetasFiltro1: arrTarjetasAmarillasAcumuladas,\n      tarjetasFiltro2: arrTarjetasAmarillasAcumuladasCerradas,\n      tarjetasFiltro3: arrTarjetasAmarillasAcumuladasCerradasPorcentaje,\n      tarjetasmesabiertas: array,\n      tarjetasmescerradas: arrayCerradas,\n      color: \"Amarillas\",\n      fechas: fechastarjetasUnicasRangoCut,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 500,\n        columnNumber: 13\n      }\n    }))));\n  }\n\n}\nexport default GraficoAmarillas;","map":{"version":3,"sources":["/Users/fedepoi/klockner_tpm/client/src/components/dasboard/tarjetasamarillas/GraficoAmarillas.jsx"],"names":["React","Component","CanvasJSReact","moment","months","TableModal","Col","Row","Card","CardBody","Table","Input","MoreVertIcon","CanvasJSChart","CanvasJS","GraficoAmarillas","constructor","onChange","e","target","value","setState","name","state","numberMonths","toggleDataSeries","bind","dataSeries","visible","chart","render","tarjetas","props","console","log","fechasTarjetasAmarillas","filter","estado","color","map","fecha","substr","fechasTarjetasAmarillasCerradas","finReparacion","fechasTarjetasAmarillas1","Set","fechasTarjetasAmarillasUnicas","fechasTarjetasAmarillas1Cerradas","fechasTarjetasAmarillasUnicasCerradas","c","concat","fechastarjetasUnicas","item","pos","indexOf","startDate","sort","endDate","slice","fechastarjetasUnicasRango","isBefore","push","format","add","fechastarjetasUnicasRangoCut","Math","max","length","array","index","arrTarjetasAmarillasAcumuladas","elem","reduce","a","b","AmarillasAcumuladasAbiertasData","x","Date","parseInt","y","arrayCerradas","arrTarjetasAmarillasAcumuladasCerradas","aa","bb","AmarillasAcumuladasAbiertasDataCerradas","arrayCerradasPorcentaje","arrTarjetasAmarillasAcumuladasCerradasPorcentaje","AmarillasAcumuladasAbiertasDataCerradasPorcentaje","arrayMonths","addCultureInfo","decimalSeparator","digitGroupSeparator","options","culture","animationEnabled","axisX","valueFormatString","interval","intervalType","axisY","title","lineColor","tickColor","labelFontColor","axisY2","suffix","toolTip","shared","legend","cursor","itemclick","verticalAlign","data","type","showInLegend","xValueFormatString","dataPoints","axisYType","yValueFormatString","link_id","location","pathname","numero","completeLink","imagen","undefined","localStorage","token","user","role","descripcion","prioridad","familia","maquina","equipo","sugerencia","detecto","tipodeRiesgo","riesgoInicial","inicioReparacion","responsable","riesgoFinal","tiempoEmpleado","causa","tareaRealizada","tipoAccion","materialUtilizado","_id","sustoExperimentado","sustoObservado","impactoAmbiente","accionesComplementarias","plan","previstaCierre","responsableSeguimiento","recursos","materiales","solicitudCompras","comprometidaCompras","tareaRealizar","responsableTarea","comentario1","comentario2","comentario3","onDeleteClick","ref"],"mappings":";AAAA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,OAAOC,aAAP,MAA0B,mBAA1B;AACA,OAAOC,MAAP,IAAiBC,MAAjB,QAA+B,QAA/B;AACA,OAAOC,UAAP,MAAuB,0BAAvB;AACA,SAASC,GAAT,EAAcC,GAAd,EAAmBC,IAAnB,EAAyBC,QAAzB,EAAmCC,KAAnC,EAA0CC,KAA1C,QAAuD,YAAvD;AACA,OAAOC,YAAP,MAAyB,6BAAzB;AACA,IAAIC,aAAa,GAAGX,aAAa,CAACW,aAAlC;AACA,IAAIC,QAAQ,GAAGZ,aAAa,CAACY,QAA7B;AAEA,OAAO,MAAMC,gBAAN,SAA+Bd,SAA/B,CAAyC;AAC9Ce,EAAAA,WAAW,GAAG;AACZ;;AADY,SAgBdC,QAhBc,GAgBFC,CAAD,IAAO;AAChBA,MAAAA,CAAC,CAACC,MAAF,CAASC,KAAT,KAAmB,EAAnB,GACI,KAAKC,QAAL,CAAc;AACZ,SAACH,CAAC,CAACC,MAAF,CAASG,IAAV,GAAiB;AADL,OAAd,CADJ,GAII,KAAKD,QAAL,CAAc;AACZ,SAACH,CAAC,CAACC,MAAF,CAASG,IAAV,GAAiBJ,CAAC,CAACC,MAAF,CAASC;AADd,OAAd,CAJJ;AAOD,KAxBa;;AAEZ,SAAKG,KAAL,GAAa;AACXC,MAAAA,YAAY,EAAE;AADH,KAAb;AAGA,SAAKC,gBAAL,GAAwB,KAAKA,gBAAL,CAAsBC,IAAtB,CAA2B,IAA3B,CAAxB;AACD;;AACDD,EAAAA,gBAAgB,CAACP,CAAD,EAAI;AAClB,QAAI,OAAOA,CAAC,CAACS,UAAF,CAAaC,OAApB,KAAgC,WAAhC,IAA+CV,CAAC,CAACS,UAAF,CAAaC,OAAhE,EAAyE;AACvEV,MAAAA,CAAC,CAACS,UAAF,CAAaC,OAAb,GAAuB,KAAvB;AACD,KAFD,MAEO;AACLV,MAAAA,CAAC,CAACS,UAAF,CAAaC,OAAb,GAAuB,IAAvB;AACD;;AACD,SAAKC,KAAL,CAAWC,MAAX;AACD;;AAYDA,EAAAA,MAAM,GAAG;AACP,UAAM;AAAEC,MAAAA;AAAF,QAAe,KAAKC,KAA1B;AACAC,IAAAA,OAAO,CAACC,GAAR,CAAY,KAAKX,KAAjB,EAFO,CAGP;AAEA;;AACA,UAAMY,uBAAuB,GAAGJ,QAAQ,CACrCK,MAD6B,CACtB,CAAC;AAAEC,MAAAA,MAAF;AAAUC,MAAAA;AAAV,KAAD,KAAuBA,KAAK,KAAK,UADX,EAE7BC,GAF6B,CAEzB,CAAC;AAAEC,MAAAA;AAAF,KAAD,KAAeA,KAAK,CAACC,MAAN,CAAa,CAAb,EAAgB,CAAhB,CAFU,CAAhC,CANO,CAUP;;AACA,UAAMC,+BAA+B,GAAGX,QAAQ,CAC7CK,MADqC,CAEpC,CAAC;AAAEC,MAAAA,MAAF;AAAUC,MAAAA;AAAV,KAAD,KAAuBD,MAAM,KAAK,SAAX,IAAwBC,KAAK,KAAK,UAFrB,EAIrCC,GAJqC,CAIjC,CAAC;AAAEI,MAAAA;AAAF,KAAD,KAAuBA,aAAa,CAACF,MAAd,CAAqB,CAArB,EAAwB,CAAxB,CAJU,CAAxC,CAXO,CAiBP;;AACA,QAAIG,wBAAwB,GAAG,IAAIC,GAAJ,CAAQV,uBAAR,CAA/B;AACA,UAAMW,6BAA6B,GAAG,CAAC,GAAGF,wBAAJ,CAAtC,CAnBO,CAqBP;;AACA,QAAIG,gCAAgC,GAAG,IAAIF,GAAJ,CACrCH,+BADqC,CAAvC;AAGA,UAAMM,qCAAqC,GAAG,CAC5C,GAAGD,gCADyC,CAA9C;AAIA,QAAIE,CAAC,GAAGH,6BAA6B,CAACI,MAA9B,CACNF,qCADM,CAAR;AAGA,QAAIG,oBAAoB,GAAGF,CAAC,CAACb,MAAF,CAAS,CAACgB,IAAD,EAAOC,GAAP,KAAeJ,CAAC,CAACK,OAAF,CAAUF,IAAV,MAAoBC,GAA5C,CAA3B;AAEA,UAAME,SAAS,GAAGpD,MAAM,CAACgD,oBAAoB,CAACK,IAArB,GAA4B,CAA5B,CAAD,CAAxB;AACA,UAAMC,OAAO,GAAGtD,MAAM,CAACgD,oBAAoB,CAACK,IAArB,GAA4BE,KAA5B,CAAkC,CAAC,CAAnC,EAAsC,CAAtC,CAAD,CAAtB;AAEA,UAAMC,yBAAyB,GAAG,EAAlC;;AAEA,QAAIF,OAAO,CAACG,QAAR,CAAiBL,SAAjB,CAAJ,EAAiC;AAC/B,YAAM,2CAAN;AACD;;AAED,WAAOA,SAAS,CAACK,QAAV,CAAmBH,OAAnB,CAAP,EAAoC;AAClCE,MAAAA,yBAAyB,CAACE,IAA1B,CAA+BN,SAAS,CAACO,MAAV,CAAiB,SAAjB,CAA/B;AACAP,MAAAA,SAAS,CAACQ,GAAV,CAAc,CAAd,EAAiB,OAAjB;AACD;;AAED,UAAMC,4BAA4B,GAAGL,yBAAyB,CAACD,KAA1B,CACnCO,IAAI,CAACC,GAAL,CAASP,yBAAyB,CAACQ,MAA1B,GAAmC,KAAK5C,KAAL,CAAWC,YAAvD,EAAqE,CAArE,CADmC,CAArC,CAhDO,CAoDP;;AACA,QAAI4C,KAAK,GAAGJ,4BAA4B,CAACR,IAA7B,GAAoCjB,GAApC,CAAwC,CAACa,IAAD,EAAOiB,KAAP,KAAiB;AACnE,aAAOtC,QAAQ,CAACK,MAAT,CACL,CAAC;AAAEC,QAAAA,MAAF;AAAUG,QAAAA,KAAV;AAAiBF,QAAAA;AAAjB,OAAD,KACEA,KAAK,KAAK,UAAV,IAAwBE,KAAK,CAACkB,KAAN,CAAY,CAAZ,EAAe,CAAf,MAAsBN,IAAI,CAACM,KAAL,CAAW,CAAX,EAAc,CAAd,CAF3C,EAGLS,MAHF;AAID,KALW,CAAZ;AAOA,UAAMG,8BAA8B,GAAGF,KAAK,CAAC7B,GAAN,CAAU,CAACgC,IAAD,EAAOF,KAAP,KAC/CD,KAAK,CAACV,KAAN,CAAY,CAAZ,EAAeW,KAAK,GAAG,CAAvB,EAA0BG,MAA1B,CAAiC,CAACC,CAAD,EAAIC,CAAJ,KAAUD,CAAC,GAAGC,CAA/C,CADqC,CAAvC,CA5DO,CAgEP;;AACA,UAAMC,+BAA+B,GAAG,CACtCX,4BAA4B,CAACR,IAA7B,GAAoCjB,GAApC,CAAwC,CAACa,IAAD,EAAOiB,KAAP,KAAiB;AACvD,aAAO;AACLO,QAAAA,CAAC,EAAE,IAAIC,IAAJ,CACDC,QAAQ,CAAC1B,IAAI,CAACM,KAAL,CAAW,CAAX,EAAc,CAAd,CAAD,CADP,EAEDoB,QAAQ,CAAC1B,IAAI,CAACM,KAAL,CAAW,CAAX,EAAc,CAAd,IAAmB,CAApB,CAFP,CADE;AAKLqB,QAAAA,CAAC,EAAET,8BAA8B,CAACD,KAAD;AAL5B,OAAP;AAOD,KARD,CADsC,CAAxC,CAjEO,CA6EP;AAEA;;AACA,QAAIW,aAAa,GAAGhB,4BAA4B,CAC7CR,IADiB,GAEjBjB,GAFiB,CAEb,CAACa,IAAD,EAAOiB,KAAP,KAAiB;AACpB,aAAOtC,QAAQ,CAACK,MAAT,CACL,CAAC;AAAEC,QAAAA,MAAF;AAAUM,QAAAA,aAAV;AAAyBL,QAAAA;AAAzB,OAAD,KACEA,KAAK,KAAK,UAAV,IACAD,MAAM,KAAK,SADX,IAEAM,aAAa,CAACe,KAAd,CAAoB,CAApB,EAAuB,CAAvB,MAA8BN,IAAI,CAACM,KAAL,CAAW,CAAX,EAAc,CAAd,CAJ3B,EAKLS,MALF;AAMD,KATiB,CAApB,CAhFO,CA2FP;;AACA,UAAMc,sCAAsC,GAAGD,aAAa,CAACzC,GAAd,CAC7C,CAACgC,IAAD,EAAOF,KAAP,KACEW,aAAa,CAACtB,KAAd,CAAoB,CAApB,EAAuBW,KAAK,GAAG,CAA/B,EAAkCG,MAAlC,CAAyC,CAACU,EAAD,EAAKC,EAAL,KAAYD,EAAE,GAAGC,EAA1D,CAF2C,CAA/C,CA5FO,CAiGP;;AACA,UAAMC,uCAAuC,GAAG,CAC9CpB,4BAA4B,CAACR,IAA7B,GAAoCjB,GAApC,CAAwC,CAACa,IAAD,EAAOiB,KAAP,KAAiB;AACvD,aAAO;AACLO,QAAAA,CAAC,EAAE,IAAIC,IAAJ,CACDC,QAAQ,CAAC1B,IAAI,CAACM,KAAL,CAAW,CAAX,EAAc,CAAd,CAAD,CADP,EAEDoB,QAAQ,CAAC1B,IAAI,CAACM,KAAL,CAAW,CAAX,EAAc,CAAd,IAAmB,CAApB,CAFP,CADE;AAKLqB,QAAAA,CAAC,EAAEE,sCAAsC,CAACZ,KAAD;AALpC,OAAP;AAOD,KARD,CAD8C,CAAhD,CAlGO,CA8GP;AAEA;;AACA,QAAIgB,uBAAuB,GAAGrB,4BAA4B,CACvDR,IAD2B,GAE3BjB,GAF2B,CAEvB,CAACa,IAAD,EAAOiB,KAAP,KAAiB;AACpB,aAAOtC,QAAQ,CAACK,MAAT,CACL,CAAC;AAAEC,QAAAA,MAAF;AAAUM,QAAAA,aAAV;AAAyBL,QAAAA;AAAzB,OAAD,KACEA,KAAK,KAAK,UAAV,IACAD,MAAM,KAAK,SADX,IAEAM,aAAa,CAACe,KAAd,CAAoB,CAApB,EAAuB,CAAvB,MAA8BN,IAAI,CAACM,KAAL,CAAW,CAAX,EAAc,CAAd,CAJ3B,EAKLS,MALF;AAMD,KAT2B,CAA9B,CAjHO,CA4HP;;AACA,UAAMmB,gDAAgD,GAAGD,uBAAuB,CAAC9C,GAAxB,CACvD,CAACgC,IAAD,EAAOF,KAAP,KACEgB,uBAAuB,CAAC3B,KAAxB,CAA8B,CAA9B,EAAiCW,KAAK,GAAG,CAAzC,EAA4CG,MAA5C,CAAmD,CAACU,EAAD,EAAKC,EAAL,KAAYD,EAAE,GAAGC,EAApE,CAFqD,CAAzD,CA7HO,CAiIP;;AAEA,UAAMI,iDAAiD,GAAG,CACxDvB,4BAA4B,CAACzB,GAA7B,CAAiC,CAACa,IAAD,EAAOiB,KAAP,KAAiB;AAChD,aAAO;AACLO,QAAAA,CAAC,EAAE,IAAIC,IAAJ,CACDC,QAAQ,CAAC1B,IAAI,CAACM,KAAL,CAAW,CAAX,EAAc,CAAd,CAAD,CADP,EAEDoB,QAAQ,CAAC1B,IAAI,CAACM,KAAL,CAAW,CAAX,EAAc,CAAd,IAAmB,CAApB,CAFP,CADE;AAKLqB,QAAAA,CAAC,EACEO,gDAAgD,CAACjB,KAAD,CAAhD,GACCC,8BAA8B,CAACD,KAAD,CADhC,GAEA;AARG,OAAP;AAUD,KAXD,CADwD,CAA1D;AAeA,UAAMmB,WAAW,GAAG,CAAC,CAAD,EAAI,CAAJ,EAAO,EAAP,EAAW,EAAX,CAApB;AAEA1E,IAAAA,QAAQ,CAAC2E,cAAT,CAAwB,IAAxB,EAA8B;AAC5BC,MAAAA,gBAAgB,EAAE,GADU;AAE5BC,MAAAA,mBAAmB,EAAE,GAFO;AAG5BvF,MAAAA,MAAM,EAAE,CACN,OADM,EAEN,SAFM,EAGN,OAHM,EAIN,OAJM,EAKN,MALM,EAMN,OANM,EAON,OAPM,EAQN,QARM,EASN,YATM,EAUN,SAVM,EAWN,WAXM,EAYN,WAZM;AAHoB,KAA9B;AAmBA,UAAMwF,OAAO,GAAG;AACdC,MAAAA,OAAO,EAAE,IADK;AAEdC,MAAAA,gBAAgB,EAAE,IAFJ;AAGdC,MAAAA,KAAK,EAAE;AACLC,QAAAA,iBAAiB,EAAE,MADd;AAELC,QAAAA,QAAQ,EAAE,CAFL;AAGLC,QAAAA,YAAY,EAAE;AAHT,OAHO;AAQdC,MAAAA,KAAK,EAAE;AACLC,QAAAA,KAAK,EAAE,sBADF;AAELC,QAAAA,SAAS,EAAE,SAFN;AAGLC,QAAAA,SAAS,EAAE,SAHN;AAILC,QAAAA,cAAc,EAAE;AAJX,OARO;AAcdC,MAAAA,MAAM,EAAE;AACNJ,QAAAA,KAAK,EAAE,aADD;AAENK,QAAAA,MAAM,EAAE,GAFF;AAGNJ,QAAAA,SAAS,EAAE,SAHL;AAINC,QAAAA,SAAS,EAAE,SAJL;AAKNC,QAAAA,cAAc,EAAE;AALV,OAdM;AAsBdG,MAAAA,OAAO,EAAE;AACPC,QAAAA,MAAM,EAAE;AADD,OAtBK;AAyBdC,MAAAA,MAAM,EAAE;AACNC,QAAAA,MAAM,EAAE,SADF;AAENC,QAAAA,SAAS,EAAE,KAAKrF,gBAFV;AAGNsF,QAAAA,aAAa,EAAE;AAHT,OAzBM;AA8BdC,MAAAA,IAAI,EAAE,CACJ;AACE1E,QAAAA,KAAK,EAAE,SADT;AAEE2E,QAAAA,IAAI,EAAE,QAFR;AAGE3F,QAAAA,IAAI,EAAE,iCAHR;AAIE4F,QAAAA,YAAY,EAAE,IAJhB;AAKEC,QAAAA,kBAAkB,EAAE,WALtB;AAMEC,QAAAA,UAAU,EAAEzC,+BAA+B,CAAC,CAAD;AAN7C,OADI,EASJ;AACEsC,QAAAA,IAAI,EAAE,MADR;AAEE3F,QAAAA,IAAI,EAAE,iCAFR;AAGE4F,QAAAA,YAAY,EAAE,IAHhB;AAIEE,QAAAA,UAAU,EAAEhC,uCAAuC,CAAC,CAAD;AAJrD,OATI,EAeJ;AACE6B,QAAAA,IAAI,EAAE,MADR;AAEE3E,QAAAA,KAAK,EAAE,SAFT;AAGEhB,QAAAA,IAAI,EAAE,+BAHR;AAIE4F,QAAAA,YAAY,EAAE,IAJhB;AAKEG,QAAAA,SAAS,EAAE,WALb;AAMEC,QAAAA,kBAAkB,EAAE,OANtB;AAOEF,QAAAA,UAAU,EAAE7B,iDAAiD,CAAC,CAAD;AAP/D,OAfI;AA9BQ,KAAhB;AAyDA,wBACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE,oBAAC,GAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE,oBAAC,GAAD;AAAK,MAAA,EAAE,EAAE,CAAT;AAAY,MAAA,EAAE,EAAE,EAAhB;AAAoB,MAAA,EAAE,EAAE,EAAxB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE,oBAAC,IAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE,oBAAC,QAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE;AAAK,MAAA,SAAS,EAAC,8BAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE;AAAK,MAAA,SAAS,EAAC,EAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE;AAAI,MAAA,SAAS,EAAC,MAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,yCADF,CADF,CADF,eAME;AAAK,MAAA,SAAS,EAAC,oDAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE,oBAAC,GAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE;AAAK,MAAA,KAAK,EAAC,UAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE,oBAAC,MAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBADF,eAEE;AAAK,MAAA,KAAK,EAAC,kBAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACGlD,MAAM,KAAK,SAAX,IAAwBC,KAAK,KAAK,UAAlC,iBACC,oBAAC,GAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE,oBAAC,kBAAD;AACE,MAAA,GAAG,EAAEiF,OADP;AAEE,MAAA,KAAK,EAAEjF,KAFT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADF,CAFJ,EASGD,MAAM,KAAK,SAAX,IAAwBC,KAAK,KAAK,UAAlC,iBACC,oBAAC,GAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE,oBAAC,0BAAD;AACE,MAAA,GAAG,EAAEiF,OADP;AAEE,MAAA,KAAK,EAAEjF,KAFT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADF,CAVJ,eAiBE,oBAAC,GAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE,oBAAC,OAAD;AACE,MAAA,IAAI,EAAE,KAAKN,KAAL,CAAWwF,QAAX,CAAoBC,QAD5B;AAEE,MAAA,KAAK,EAAEnF,KAFT;AAGE,MAAA,MAAM,EAAEoF,MAHV;AAIE,MAAA,YAAY,EAAEC,YAJhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBADF,CAjBF,EA2BGC,MAAM,CAAC,CAAD,CAAN,KAAcC,SAAd,iBACC,oBAAC,GAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE,oBAAC,gBAAD;AACE,MAAA,CAAC,EAAE,IADL;AAEE,MAAA,MAAM,EAAE,KAFV;AAGE,MAAA,GAAG,EAAEN,OAHP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADF,CA5BJ,EAqCGO,YAAY,CAACC,KAAb,IACC,KAAK/F,KAAL,CAAWgG,IADZ,IAEC,KAAKhG,KAAL,CAAWgG,IAAX,CAAgBC,IAAhB,KAAyB,cAF1B,IAGC3F,KAAK,KAAK,UAHX,iBAIG,oBAAC,GAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE,oBAAC,kBAAD;AACE,MAAA,OAAO,EAAE;AACPoF,QAAAA,MADO;AAEPQ,QAAAA,WAFO;AAGPC,QAAAA,SAHO;AAIPC,QAAAA,OAJO;AAKP5F,QAAAA,KALO;AAMP6F,QAAAA,OANO;AAOPhG,QAAAA,MAPO;AAQPiG,QAAAA,MARO;AASPC,QAAAA,UATO;AAUPC,QAAAA,OAVO;AAWPC,QAAAA,YAXO;AAYPC,QAAAA,aAZO;AAaPpG,QAAAA,KAbO;AAcPqG,QAAAA,gBAdO;AAePhG,QAAAA,aAfO;AAgBPiG,QAAAA,WAhBO;AAiBPC,QAAAA,WAjBO;AAkBPC,QAAAA,cAlBO;AAmBPC,QAAAA,KAnBO;AAoBPC,QAAAA,cApBO;AAqBPC,QAAAA,UArBO;AAsBPC,QAAAA,iBAtBO;AAuBPC,QAAAA;AAvBO,OADX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADF,CAzCN,EAuEGrB,YAAY,CAACC,KAAb,IACC,KAAK/F,KAAL,CAAWgG,IADZ,IAEC,KAAKhG,KAAL,CAAWgG,IAAX,CAAgBC,IAAhB,KAAyB,cAF1B,IAGC3F,KAAK,KAAK,UAHX,iBAIG,oBAAC,GAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE,oBAAC,0BAAD;AACE,MAAA,OAAO,EAAE;AACP6G,QAAAA,GADO;AAEPjB,QAAAA,WAFO;AAGPM,QAAAA,OAHO;AAIPL,QAAAA,SAJO;AAKPE,QAAAA,OALO;AAMPD,QAAAA,OANO;AAOPE,QAAAA,MAPO;AAQPc,QAAAA,kBARO;AASPC,QAAAA,cATO;AAUPC,QAAAA,eAVO;AAWPf,QAAAA,UAXO;AAYPE,QAAAA,YAZO;AAaPC,QAAAA,aAbO;AAcPE,QAAAA,WAdO;AAePvG,QAAAA,MAfO;AAgBP2G,QAAAA,cAhBO;AAiBPH,QAAAA,WAjBO;AAkBPI,QAAAA,UAlBO;AAmBPM,QAAAA;AAnBO,OADX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADF,CA3EN,EAqGGzB,YAAY,CAACC,KAAb,IACC,KAAK/F,KAAL,CAAWgG,IADZ,IAEC,KAAKhG,KAAL,CAAWgG,IAAX,CAAgBC,IAAhB,KAAyB,OAF1B,IAGC3F,KAAK,KAAK,UAHX,iBAIG,oBAAC,GAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE,oBAAC,kBAAD;AACE,MAAA,OAAO,EAAE;AACPoF,QAAAA,MADO;AAEPQ,QAAAA,WAFO;AAGPC,QAAAA,SAHO;AAIPC,QAAAA,OAJO;AAKP5F,QAAAA,KALO;AAMP6F,QAAAA,OANO;AAOPhG,QAAAA,MAPO;AAQPiG,QAAAA,MARO;AASPC,QAAAA,UATO;AAUPC,QAAAA,OAVO;AAWPC,QAAAA,YAXO;AAYPC,QAAAA,aAZO;AAaPpG,QAAAA,KAbO;AAcPqG,QAAAA,gBAdO;AAePhG,QAAAA,aAfO;AAgBPiG,QAAAA,WAhBO;AAiBPC,QAAAA,WAjBO;AAkBPC,QAAAA,cAlBO;AAmBPC,QAAAA,KAnBO;AAoBPC,QAAAA,cApBO;AAqBPC,QAAAA,UArBO;AAsBPC,QAAAA,iBAtBO;AAuBPC,QAAAA;AAvBO,OADX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADF,CAzGN,EAuIGrB,YAAY,CAACC,KAAb,IACC,KAAK/F,KAAL,CAAWgG,IADZ,IAEC,KAAKhG,KAAL,CAAWgG,IAAX,CAAgBC,IAAhB,KAAyB,OAF1B,IAGC3F,KAAK,KAAK,UAHX,iBAIG,oBAAC,GAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE,oBAAC,0BAAD;AACE,MAAA,OAAO,EAAE;AACP6G,QAAAA,GADO;AAEPjB,QAAAA,WAFO;AAGPM,QAAAA,OAHO;AAIPL,QAAAA,SAJO;AAKPE,QAAAA,OALO;AAMPD,QAAAA,OANO;AAOPE,QAAAA,MAPO;AAQPc,QAAAA,kBARO;AASPC,QAAAA,cATO;AAUPC,QAAAA,eAVO;AAWPf,QAAAA,UAXO;AAYPE,QAAAA,YAZO;AAaPC,QAAAA,aAbO;AAcPE,QAAAA,WAdO;AAePvG,QAAAA,MAfO;AAgBP2G,QAAAA,cAhBO;AAiBPH,QAAAA,WAjBO;AAkBPI,QAAAA,UAlBO;AAmBPM,QAAAA;AAnBO,OADX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADF,CA3IN,EAqKGC,IAAI,CAAC,CAAD,CAAJ,KAAY,KAAZ,iBACC,oBAAC,kBAAD;AACE,MAAA,GAAG,EAAEjC,OADP;AAEE,MAAA,CAAC,EAAE,IAFL;AAGE,MAAA,MAAM,EAAE,KAHV;AAIE,MAAA,OAAO,EAAE;AACPkC,QAAAA,cADO;AAEPC,QAAAA,sBAFO;AAGPC,QAAAA,QAHO;AAIPC,QAAAA,UAJO;AAKPC,QAAAA,gBALO;AAMPC,QAAAA,mBANO;AAOPC,QAAAA,aAPO;AAQPC,QAAAA,gBARO;AASPC,QAAAA,WATO;AAUPC,QAAAA,WAVO;AAWPC,QAAAA;AAXO,OAJX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAtKJ,EA0LGrC,YAAY,CAACC,KAAb,IACC,KAAK/F,KAAL,CAAWgG,IADZ,IAEC,KAAKhG,KAAL,CAAWgG,IAAX,CAAgBC,IAAhB,KAAyB,OAF1B,iBAGG,oBAAC,GAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE;AACE,oBAAW,QADb;AAEE,MAAA,OAAO,EAAE,KAAKmC,aAAL,CAAmB1I,IAAnB,CAAwB,IAAxB,EAA8ByH,GAA9B,CAFX;AAGE,MAAA,KAAK,EAAE;AAAEtC,QAAAA,MAAM,EAAE;AAAV,OAHT;AAIE,MAAA,SAAS,EAAC,MAJZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBADF,CA7LN,CAFF,CADF,eA6ME,oBAAC,YAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MA7MF,CADF,CANF,CADF,eA0NE,oBAAC,aAAD;AACE,MAAA,OAAO,EAAC,IADV;AAEE,MAAA,OAAO,EAAEjB,OAFX;AAGE,MAAA,KAAK,EAAGyE,GAAD,IAAU,KAAKxI,KAAL,GAAawI,GAHhC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MA1NF,eA+NE,oBAAC,KAAD;AACE,MAAA,IAAI,EAAC,QADP;AAEE,MAAA,IAAI,EAAC,cAFP;AAGE,MAAA,EAAE,EAAC,cAHL;AAIE,MAAA,SAAS,EAAC,MAJZ;AAKE,MAAA,QAAQ,EAAE,KAAKpJ,QALjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MA/NF,CADF,CADF,CADF,eA4OE,oBAAC,GAAD;AAAK,MAAA,EAAE,EAAE,CAAT;AAAY,MAAA,EAAE,EAAE,EAAhB;AAAoB,MAAA,EAAE,EAAE,EAAxB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE,oBAAC,UAAD;AACE,MAAA,eAAe,EAAEqD,8BADnB;AAEE,MAAA,eAAe,EAAEW,sCAFnB;AAGE,MAAA,eAAe,EAAEK,gDAHnB;AAIE,MAAA,mBAAmB,EAAElB,KAJvB;AAKE,MAAA,mBAAmB,EAAEY,aALvB;AAME,MAAA,KAAK,EAAC,WANR;AAOE,MAAA,MAAM,EAAEhB,4BAPV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADF,CA5OF,CADF,CADF;AA4PD;;AAvf6C;AA0fhD,eAAejD,gBAAf","sourcesContent":["import React, { Component } from \"react\";\nimport CanvasJSReact from \"../canvasjs.react\";\nimport moment, { months } from \"moment\";\nimport TableModal from \"../tablemodal/TableModal\";\nimport { Col, Row, Card, CardBody, Table, Input } from \"reactstrap\";\nimport MoreVertIcon from \"@material-ui/icons/MoreVert\";\nvar CanvasJSChart = CanvasJSReact.CanvasJSChart;\nvar CanvasJS = CanvasJSReact.CanvasJS;\n\nexport class GraficoAmarillas extends Component {\n  constructor() {\n    super();\n    this.state = {\n      numberMonths: \"12\",\n    };\n    this.toggleDataSeries = this.toggleDataSeries.bind(this);\n  }\n  toggleDataSeries(e) {\n    if (typeof e.dataSeries.visible === \"undefined\" || e.dataSeries.visible) {\n      e.dataSeries.visible = false;\n    } else {\n      e.dataSeries.visible = true;\n    }\n    this.chart.render();\n  }\n\n  onChange = (e) => {\n    e.target.value === \"\"\n      ? this.setState({\n          [e.target.name]: 12,\n        })\n      : this.setState({\n          [e.target.name]: e.target.value,\n        });\n  };\n\n  render() {\n    const { tarjetas } = this.props;\n    console.log(this.state);\n    // Formulas para \"Amarillas acumuladas abiertas\"\n\n    // Filtro todos los meses en el que hay tarjetas abiertas Amarillas\n    const fechasTarjetasAmarillas = tarjetas\n      .filter(({ estado, color }) => color === \"Amarilla\")\n      .map(({ fecha }) => fecha.substr(0, 7));\n\n    // Filtro todos los meses en el que hay tarjetas cerradas Amarillas\n    const fechasTarjetasAmarillasCerradas = tarjetas\n      .filter(\n        ({ estado, color }) => estado === \"Cerrada\" && color === \"Amarilla\"\n      )\n      .map(({ finReparacion }) => finReparacion.substr(0, 7));\n\n    // Borro todos los meses repetidos\n    let fechasTarjetasAmarillas1 = new Set(fechasTarjetasAmarillas);\n    const fechasTarjetasAmarillasUnicas = [...fechasTarjetasAmarillas1];\n\n    // Borro todos los meses repetidos\n    let fechasTarjetasAmarillas1Cerradas = new Set(\n      fechasTarjetasAmarillasCerradas\n    );\n    const fechasTarjetasAmarillasUnicasCerradas = [\n      ...fechasTarjetasAmarillas1Cerradas,\n    ];\n\n    var c = fechasTarjetasAmarillasUnicas.concat(\n      fechasTarjetasAmarillasUnicasCerradas\n    );\n    var fechastarjetasUnicas = c.filter((item, pos) => c.indexOf(item) === pos);\n\n    const startDate = moment(fechastarjetasUnicas.sort()[0]);\n    const endDate = moment(fechastarjetasUnicas.sort().slice(-1)[1]);\n\n    const fechastarjetasUnicasRango = [];\n\n    if (endDate.isBefore(startDate)) {\n      throw \"End date must be greated than start date.\";\n    }\n\n    while (startDate.isBefore(endDate)) {\n      fechastarjetasUnicasRango.push(startDate.format(\"YYYY-MM\"));\n      startDate.add(1, \"month\");\n    }\n\n    const fechastarjetasUnicasRangoCut = fechastarjetasUnicasRango.slice(\n      Math.max(fechastarjetasUnicasRango.length - this.state.numberMonths, 1)\n    );\n\n    // Numero total de tarjetas de cada mes (no acumulado)\n    let array = fechastarjetasUnicasRangoCut.sort().map((item, index) => {\n      return tarjetas.filter(\n        ({ estado, fecha, color }) =>\n          color === \"Amarilla\" && fecha.slice(0, 7) === item.slice(0, 7)\n      ).length;\n    });\n\n    const arrTarjetasAmarillasAcumuladas = array.map((elem, index) =>\n      array.slice(0, index + 1).reduce((a, b) => a + b)\n    );\n\n    // Datos para el grafico\n    const AmarillasAcumuladasAbiertasData = [\n      fechastarjetasUnicasRangoCut.sort().map((item, index) => {\n        return {\n          x: new Date(\n            parseInt(item.slice(0, 4)),\n            parseInt(item.slice(5, 7) - 1)\n          ),\n          y: arrTarjetasAmarillasAcumuladas[index],\n        };\n      }),\n    ];\n\n    // Formulas para \"Amarillas acumuladas cerradas\"\n\n    // Numero total de tarjetas de cada mes (no acumulado)\n    let arrayCerradas = fechastarjetasUnicasRangoCut\n      .sort()\n      .map((item, index) => {\n        return tarjetas.filter(\n          ({ estado, finReparacion, color }) =>\n            color === \"Amarilla\" &&\n            estado === \"Cerrada\" &&\n            finReparacion.slice(0, 7) === item.slice(0, 7)\n        ).length;\n      });\n\n    // Acumulado de tarjetas por mes\n    const arrTarjetasAmarillasAcumuladasCerradas = arrayCerradas.map(\n      (elem, index) =>\n        arrayCerradas.slice(0, index + 1).reduce((aa, bb) => aa + bb)\n    );\n\n    // Datos para el grafico\n    const AmarillasAcumuladasAbiertasDataCerradas = [\n      fechastarjetasUnicasRangoCut.sort().map((item, index) => {\n        return {\n          x: new Date(\n            parseInt(item.slice(0, 4)),\n            parseInt(item.slice(5, 7) - 1)\n          ),\n          y: arrTarjetasAmarillasAcumuladasCerradas[index],\n        };\n      }),\n    ];\n\n    // Formulas para \"Porcentaje acumuladas cerradas porcentaje\"\n\n    // Numero total de tarjetas de cada mes (no acumulado)\n    let arrayCerradasPorcentaje = fechastarjetasUnicasRangoCut\n      .sort()\n      .map((item, index) => {\n        return tarjetas.filter(\n          ({ estado, finReparacion, color }) =>\n            color === \"Amarilla\" &&\n            estado === \"Cerrada\" &&\n            finReparacion.slice(0, 7) === item.slice(0, 7)\n        ).length;\n      });\n\n    // Acumulado de tarjetas por mes\n    const arrTarjetasAmarillasAcumuladasCerradasPorcentaje = arrayCerradasPorcentaje.map(\n      (elem, index) =>\n        arrayCerradasPorcentaje.slice(0, index + 1).reduce((aa, bb) => aa + bb)\n    );\n    // Datos para el grafico de cerradas porcentaje\n\n    const AmarillasAcumuladasAbiertasDataCerradasPorcentaje = [\n      fechastarjetasUnicasRangoCut.map((item, index) => {\n        return {\n          x: new Date(\n            parseInt(item.slice(0, 4)),\n            parseInt(item.slice(5, 7) - 1)\n          ),\n          y:\n            (arrTarjetasAmarillasAcumuladasCerradasPorcentaje[index] /\n              arrTarjetasAmarillasAcumuladas[index]) *\n            100,\n        };\n      }),\n    ];\n\n    const arrayMonths = [1, 5, 10, 15];\n\n    CanvasJS.addCultureInfo(\"es\", {\n      decimalSeparator: \".\",\n      digitGroupSeparator: \",\",\n      months: [\n        \"Enero\",\n        \"Febrero\",\n        \"Marzo\",\n        \"Abril\",\n        \"Mayo\",\n        \"Junio\",\n        \"Julio\",\n        \"Agosto\",\n        \"Septiembre\",\n        \"Octubre\",\n        \"Noviembre\",\n        \"Diciembre\",\n      ],\n    });\n\n    const options = {\n      culture: \"es\",\n      animationEnabled: true,\n      axisX: {\n        valueFormatString: \"MMMM\",\n        interval: 1,\n        intervalType: \"month\",\n      },\n      axisY: {\n        title: \"Cantidad de tarjetas\",\n        lineColor: \"#000000\",\n        tickColor: \"#000000\",\n        labelFontColor: \"#000000\",\n      },\n      axisY2: {\n        title: \"% de Cierre\",\n        suffix: \"%\",\n        lineColor: \"#000000\",\n        tickColor: \"#000000\",\n        labelFontColor: \"#000000\",\n      },\n\n      toolTip: {\n        shared: true,\n      },\n      legend: {\n        cursor: \"pointer\",\n        itemclick: this.toggleDataSeries,\n        verticalAlign: \"top\",\n      },\n      data: [\n        {\n          color: \"#F7E91B\",\n          type: \"column\",\n          name: \"Amarillas acumuladas (abiertas)\",\n          showInLegend: true,\n          xValueFormatString: \"MMMM YYYY\",\n          dataPoints: AmarillasAcumuladasAbiertasData[0],\n        },\n        {\n          type: \"line\",\n          name: \"Amarillas acumuladas (cerradas)\",\n          showInLegend: true,\n          dataPoints: AmarillasAcumuladasAbiertasDataCerradas[0],\n        },\n        {\n          type: \"line\",\n          color: \"#121212\",\n          name: \"Porcentaje Amarillas Cerradas\",\n          showInLegend: true,\n          axisYType: \"secondary\",\n          yValueFormatString: \"#,##0\",\n          dataPoints: AmarillasAcumuladasAbiertasDataCerradasPorcentaje[0],\n        },\n      ],\n    };\n\n    return (\n      <div>\n        <Row>\n          <Col lg={5} md={12} sm={12}>\n            <Card>\n              <CardBody>\n                <div className=\"d-sm-flex align-items-center\">\n                  <div className=\"\">\n                    <div>\n                      <h3 className=\"mb-3\">Evolucion de Tarjetas amarillas</h3>\n                    </div>\n                  </div>\n                  <div className=\"ml-auto d-sm-flex no-block align-items-center mb-3\">\n                    <Col>\n                      <div class=\"dropdown\">\n                        <Button>Opciones</Button>\n                        <div class=\"dropdown-content\">\n                          {estado === \"Abierta\" && color !== \"Amarilla\" && (\n                            <Col>\n                              <CerrarTarjetaModal\n                                _id={link_id}\n                                color={color}\n                              ></CerrarTarjetaModal>\n                            </Col>\n                          )}\n                          {estado === \"Abierta\" && color === \"Amarilla\" && (\n                            <Col>\n                              <CerrarTarjetaAmarillaModal\n                                _id={link_id}\n                                color={color}\n                              ></CerrarTarjetaAmarillaModal>\n                            </Col>\n                          )}\n                          <Col>\n                            <QRModal\n                              path={this.props.location.pathname}\n                              color={color}\n                              numero={numero}\n                              completePath={completeLink}\n                            >\n                              Mostrar QR\n                            </QRModal>\n                          </Col>\n                          {imagen[0] === undefined && (\n                            <Col>\n                              <UploadImageModal\n                                p={true}\n                                button={false}\n                                _id={link_id}\n                              ></UploadImageModal>\n                            </Col>\n                          )}\n\n                          {localStorage.token &&\n                            this.props.user &&\n                            this.props.user.role === \"Jefe de area\" &&\n                            color !== \"Amarilla\" && (\n                              <Col>\n                                <EditarTarjetaModal\n                                  tarjeta={{\n                                    numero,\n                                    descripcion,\n                                    prioridad,\n                                    familia,\n                                    fecha,\n                                    maquina,\n                                    estado,\n                                    equipo,\n                                    sugerencia,\n                                    detecto,\n                                    tipodeRiesgo,\n                                    riesgoInicial,\n                                    color,\n                                    inicioReparacion,\n                                    finReparacion,\n                                    responsable,\n                                    riesgoFinal,\n                                    tiempoEmpleado,\n                                    causa,\n                                    tareaRealizada,\n                                    tipoAccion,\n                                    materialUtilizado,\n                                    _id,\n                                  }}\n                                ></EditarTarjetaModal>\n                              </Col>\n                            )}\n                          {localStorage.token &&\n                            this.props.user &&\n                            this.props.user.role === \"Jefe de area\" &&\n                            color === \"Amarilla\" && (\n                              <Col>\n                                <EditarTarjetaModalAmarilla\n                                  tarjeta={{\n                                    _id,\n                                    descripcion,\n                                    detecto,\n                                    prioridad,\n                                    maquina,\n                                    familia,\n                                    equipo,\n                                    sustoExperimentado,\n                                    sustoObservado,\n                                    impactoAmbiente,\n                                    sugerencia,\n                                    tipodeRiesgo,\n                                    riesgoInicial,\n                                    responsable,\n                                    estado,\n                                    tareaRealizada,\n                                    riesgoFinal,\n                                    tipoAccion,\n                                    accionesComplementarias,\n                                  }}\n                                ></EditarTarjetaModalAmarilla>\n                              </Col>\n                            )}\n                          {localStorage.token &&\n                            this.props.user &&\n                            this.props.user.role === \"Admin\" &&\n                            color !== \"Amarilla\" && (\n                              <Col>\n                                <EditarTarjetaModal\n                                  tarjeta={{\n                                    numero,\n                                    descripcion,\n                                    prioridad,\n                                    familia,\n                                    fecha,\n                                    maquina,\n                                    estado,\n                                    equipo,\n                                    sugerencia,\n                                    detecto,\n                                    tipodeRiesgo,\n                                    riesgoInicial,\n                                    color,\n                                    inicioReparacion,\n                                    finReparacion,\n                                    responsable,\n                                    riesgoFinal,\n                                    tiempoEmpleado,\n                                    causa,\n                                    tareaRealizada,\n                                    tipoAccion,\n                                    materialUtilizado,\n                                    _id,\n                                  }}\n                                ></EditarTarjetaModal>\n                              </Col>\n                            )}\n                          {localStorage.token &&\n                            this.props.user &&\n                            this.props.user.role === \"Admin\" &&\n                            color === \"Amarilla\" && (\n                              <Col>\n                                <EditarTarjetaModalAmarilla\n                                  tarjeta={{\n                                    _id,\n                                    descripcion,\n                                    detecto,\n                                    prioridad,\n                                    maquina,\n                                    familia,\n                                    equipo,\n                                    sustoExperimentado,\n                                    sustoObservado,\n                                    impactoAmbiente,\n                                    sugerencia,\n                                    tipodeRiesgo,\n                                    riesgoInicial,\n                                    responsable,\n                                    estado,\n                                    tareaRealizada,\n                                    riesgoFinal,\n                                    tipoAccion,\n                                    accionesComplementarias,\n                                  }}\n                                ></EditarTarjetaModalAmarilla>\n                              </Col>\n                            )}\n                          {plan[0] === false && (\n                            <PlanificacionModal\n                              _id={link_id}\n                              p={true}\n                              button={false}\n                              tarjeta={{\n                                previstaCierre,\n                                responsableSeguimiento,\n                                recursos,\n                                materiales,\n                                solicitudCompras,\n                                comprometidaCompras,\n                                tareaRealizar,\n                                responsableTarea,\n                                comentario1,\n                                comentario2,\n                                comentario3,\n                              }}\n                            ></PlanificacionModal>\n                          )}\n\n                          {localStorage.token &&\n                            this.props.user &&\n                            this.props.user.role === \"Admin\" && (\n                              <Col>\n                                <p\n                                  text-color=\"danger\"\n                                  onClick={this.onDeleteClick.bind(this, _id)}\n                                  style={{ cursor: \"pointer\" }}\n                                  className=\"my-3\"\n                                >\n                                  Borrar Tarjeta\n                                </p>\n                              </Col>\n                            )}\n                        </div>\n                      </div>\n                      <MoreVertIcon></MoreVertIcon>\n                    </Col>\n                  </div>\n                </div>\n\n                <CanvasJSChart\n                  culture=\"en\"\n                  options={options}\n                  onRef={(ref) => (this.chart = ref)}\n                />\n                <Input\n                  type=\"number\"\n                  name=\"numberMonths\"\n                  id=\"numberMonths\"\n                  className=\"mt-2\"\n                  onChange={this.onChange}\n                ></Input>\n              </CardBody>\n            </Card>\n          </Col>\n          <Col lg={7} md={12} sm={12}>\n            <TableModal\n              tarjetasFiltro1={arrTarjetasAmarillasAcumuladas}\n              tarjetasFiltro2={arrTarjetasAmarillasAcumuladasCerradas}\n              tarjetasFiltro3={arrTarjetasAmarillasAcumuladasCerradasPorcentaje}\n              tarjetasmesabiertas={array}\n              tarjetasmescerradas={arrayCerradas}\n              color=\"Amarillas\"\n              fechas={fechastarjetasUnicasRangoCut}\n            ></TableModal>\n          </Col>\n        </Row>\n      </div>\n    );\n  }\n}\n\nexport default GraficoAmarillas;\n"]},"metadata":{},"sourceType":"module"}